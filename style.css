
/* Custom Font */
body {
    font-family: 'Open Sans', sans-serif;
    overflow-x: hidden; /* Prevent horizontal scroll from cloud shapes */
}
.font-title {
    font-family: 'Fredoka One', cursive;
}

/* --- NEW ANIMATED GAME-LIKE THEME --- */

/* Bubbly Button Effects */
.bubbly-button {
    transition: transform 0.1s ease-out, box-shadow 0.1s ease-out;
    will-change: transform;
}
.bubbly-button:active {
    transform: scale(0.95);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Wobble Animation */
@keyframes wobble {
    0%, 100% { transform: rotate(-1deg); }
    50% { transform: rotate(1deg); }
}
.wobble {
    animation: wobble 2s ease-in-out infinite;
}

/* Wobbly Text (for login) */
@keyframes wobbly-text {
    0%, 100% { transform: scale(1); }
    25% { transform: scale(1.02) rotate(-1deg); }
    75% { transform: scale(0.98) rotate(1deg); }
}
.wobbly-title {
    animation: wobbly-text 4s ease-in-out infinite;
    display: inline-block;
}

@keyframes subtle-pulse-title {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.05); opacity: 0.9; }
}
.login-title-pulse {
    animation: subtle-pulse-title 5s ease-in-out infinite;
}


/* Pop-in Animation (now transition-based for flexibility) */
.pop-in {
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.2s ease-out;
    will-change: transform, opacity;
    opacity: 1;
    transform: scale(1);
}
.modal-origin-start, .pop-in-start {
    transform: scale(0);
    opacity: 0;
}


/* FIX: Pop-out Animation for Modals */
@keyframes pop-out {
    from { transform: scale(1); opacity: 1; }
    to { transform: scale(0.95); opacity: 0; }
}
.pop-out {
    animation: pop-out 0.2s ease-in forwards;
}


/* NEW: Sparkle animation for star counters */
@keyframes sparkle {
    0%, 100% { 
        transform: scale(1);
        filter: brightness(1);
    }
    50% { 
        transform: scale(1.1); 
        filter: brightness(1.5) drop-shadow(0 0 5px #FBBF24);
    }
}
.sparkle {
    animation: sparkle 0.5s ease-out;
}

@keyframes soft-pulse {
    0%, 100% { transform: scale(1); filter: brightness(1); }
    50% { transform: scale(1.02); filter: brightness(1.1); }
}
.pulse-subtle {
    animation: soft-pulse 4s ease-in-out infinite;
    display: inline-block;
    will-change: transform;
}

@keyframes hover-pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.03); }
}

.date-time-hover-group:hover #current-date,
.date-time-hover-group:hover #current-time {
    animation: hover-pulse 0.8s ease-in-out;
}

/* --- DATE & TIME GLOW EFFECTS --- */

/* Base Text Style (Always White) */
#current-date, #current-time {
    color: #ffffff !important;
    transition: text-shadow 2s ease-in-out;
}

/* --- DEPTH SHADOW & GLOW EFFECTS (No Outline) --- */

/* Base Text Style */
#current-date, #current-time {
    color: #ffffff !important;
    transition: text-shadow 1s ease-in-out;
}

/* --- NEW NAVIGATION BAR STYLES --- */
@keyframes nav-pop {
    0% { transform: scale(0.9); }
    80% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.nav-button {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    border-radius: 1rem;
    color: white;
    transition: all 150ms ease-out;
    font-weight: 700;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    border-bottom: 4px solid rgba(0,0,0,0.2);
    transform: scale(0.95);
    opacity: 0.8;
}
.nav-button .icon {
    font-size: 1.25rem;
}
.nav-button .text {
    font-size: 0.75rem;
    font-weight: 700;
    display: none;
}
@media (min-width: 768px) {
    .nav-button .text {
        display: block;
    }
}

.nav-button.active {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transform: scale(1);
    opacity: 1;
    border-bottom-width: 2px;
    animation: nav-pop 0.2s ease-out;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.8), 0 2px 4px rgba(0,0,0,0.4);
}

/* Individual Nav Button Colors */
.nav-color-cyan { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #06b6d4; --tw-gradient-to: #22d3ee; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #0891B2; }
.nav-color-cyan.active { --tw-gradient-from: #22d3ee; --tw-gradient-to: #67e8f9; }
.nav-color-amber { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #f59e0b; --tw-gradient-to: #fbbf24; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #B45309; }
.nav-color-amber.active { --tw-gradient-from: #fbbf24; --tw-gradient-to: #fcd34d; }
.nav-color-purple { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #a855f7; --tw-gradient-to: #c084fc; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #5B21B6; }
.nav-color-purple.active { --tw-gradient-from: #c084fc; --tw-gradient-to: #d8b4fe; }
.nav-color-green { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #22c55e; --tw-gradient-to: #4ade80; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #047857; }
.nav-color-green.active { --tw-gradient-from: #4ade80; --tw-gradient-to: #86efac; }
.nav-color-rose { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #f43f5e; --tw-gradient-to: #fb7185; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #9F1239; }
.nav-color-rose.active { --tw-gradient-from: #fb7185; --tw-gradient-to: #fda4af; }
.nav-color-blue { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #3b82f6; --tw-gradient-to: #60a5fa; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #1D4ED8; }
.nav-color-blue.active { --tw-gradient-from: #60a5fa; --tw-gradient-to: #93c5fd; }
.nav-color-indigo { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #6366f1; --tw-gradient-to: #818cf8; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #3730A3; }
.nav-color-indigo.active { --tw-gradient-from: #818cf8; --tw-gradient-to: #a5b4fc; }
.nav-color-gray { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #6b7280; --tw-gradient-to: #9ca3af; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #374151; }
.nav-color-gray.active { --tw-gradient-from: #9ca3af; --tw-gradient-to: #d1d5db; }
.nav-color-teal { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #14b8a6; --tw-gradient-to: #2dd4bf; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #0F766E; }
.nav-color-teal.active { --tw-gradient-from: #2dd4bf; --tw-gradient-to: #5eead4; }
.nav-color-scroll { background-image: linear-gradient(to top, var(--tw-gradient-stops)); --tw-gradient-from: #d97706; --tw-gradient-to: #f59e0b; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); border-bottom-color: #9A3412; }
.nav-color-scroll.active { --tw-gradient-from: #f59e0b; --tw-gradient-to: #fbbf24; }

/* New Header with Swirling Clouds */
@keyframes swirl {
    0% { transform: translateX(-100%) translateY(-20px) rotate(-10deg); opacity: 0; }
    10% { opacity: 0.7; }
    90% { opacity: 0.7; }
    100% { transform: translateX(100vw) translateY(20px) rotate(10deg); opacity: 0; }
}
.cloud {
    position: absolute;
    font-size: 8rem;
    color: rgba(255, 255, 255, 0.5);
    animation: swirl 30s linear infinite;
    z-index: 1;
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.5), 2px 2px 5px rgba(100, 150, 255, 0.5);
}
.cloud-fast {
    animation-duration: 35s;
}

/* --- V3.5: Upgraded Praise Toast (V4.1.2 Fix) --- */
@keyframes praise-pop {
    0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
    60% { transform: scale(1.1) rotate(5deg); opacity: 1; }
    80% { transform: scale(0.95) rotate(-2deg); }
    100% { transform: scale(1) rotate(0deg); }
}

@keyframes praise-pop-out {
    0% { transform: scale(1) rotate(0deg); opacity: 1; }
    20% { transform: scale(1.05) rotate(-2deg); opacity: 1; }
    100% { transform: scale(0.5) rotate(10deg); opacity: 0; }
}

.praise-toast {
    position: relative;
    background: white;
    border-radius: 50% 60% 70% 40% / 60% 70% 50% 60%; /* Cute cloud shape */
    width: 350px; /* V4.1.2: Made smaller */
    max-width: 90vw;
    padding: 1.75rem 2.5rem; 
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    border: 4px solid #FDE68A;
    animation: praise-pop 0.5s ease-out forwards;
}
.praise-toast.disappearing {
    animation: praise-pop-out 0.4s ease-in forwards;
}
.praise-toast-content {
    display: flex;
    align-items: center;
    gap: 0.75rem; /* 12px */
}
.praise-toast-text {
    font-size: 1.25rem; 
    font-weight: 600;
    color: #4B5563; /* gray-600 */
    line-height: 1.4;
}
.praise-toast-icon {
    font-size: 2.25rem; 
}

/* --- V4.7: REDESIGNED AWARD STARS STYLES --- */
@keyframes float-card {
    0%, 100% { transform: translateY(-3px); }
    50% { transform: translateY(3px); }
}
@keyframes star-jiggle {
    0%, 100% { transform: rotate(0deg) scale(1); }
    25% { transform: rotate(-5deg) scale(1.1); }
    75% { transform: rotate(5deg) scale(1.1); }
}

.star-award-btn {
    font-family: 'Fredoka One', cursive;
    color: white;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transition: all 150ms ease-out;
    transform: none;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    font-size: 1.5rem; /* Larger base size */
    padding: 0.75rem 1rem;
    border-radius: 9999px; /* Pill shape */
    border-bottom: 4px solid rgba(0,0,0,0.2);
    position: relative; /* For animation pseudo-elements */
}
.star-award-btn .fa-star {
    color: #FFD700; /* Gold color for stars */
    text-shadow: 0 1px 1px rgba(0,0,0,0.3);
}
.star-award-btn:hover {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    transform: scale(1.05);
}
.star-award-btn:hover .fa-star {
    animation: star-jiggle 0.5s ease-in-out;
}

.star-btn-1 { 
    background-image: linear-gradient(to right, var(--tw-gradient-stops));
    --tw-gradient-from: #22d3ee;
    --tw-gradient-to: #3b82f6;
    --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);
    border-bottom-color: #1D4ED8;
    --glow-color-1: #38BDF8;
    --glow-color-2: rgba(56, 189, 248, 0.5);
}
.star-btn-2 { 
    background-image: linear-gradient(to right, var(--tw-gradient-stops));
    --tw-gradient-from: #c084fc;
    --tw-gradient-to: #ec4899;
    --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);
    border-bottom-color: #BE185D;
    font-size: 1.6rem;
    --glow-color-1: #F472B6;
    --glow-color-2: rgba(244, 114, 182, 0.5);
}
.star-btn-3 { 
    background-image: linear-gradient(to right, var(--tw-gradient-stops));
    --tw-gradient-from: #fbbf24;
    --tw-gradient-to: #f97316;
    --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);
    border-bottom-color: #C2410C;
    font-size: 1.7rem;
    text-shadow: 0 2px 3px rgba(0,0,0,0.3);
    --glow-color-1: #FBBF24;
    --glow-color-2: rgba(251, 191, 36, 0.6);
}

/* --- V4.7: NEW STUDENT CLOUD CARD & ANIMATIONS --- */
.student-cloud-card {
    background-color: white;
    position: relative;
    padding: 1rem 1.5rem 1.5rem 1.5rem; /* Adjusted padding for avatar */
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    filter: drop-shadow(0 5px 8px rgba(0, 0, 0, 0.15));
    transform: translateZ(0);
    animation: float-card 6s ease-in-out infinite;
    padding-top: 40px; /* Make space for the overlapping avatar */
}

.student-avatar-cloud {
    position: absolute;
    top: -30px; /* Position it to overlap the top edge */
    left: 50%;
    transform: translateX(-50%);
    width: 70px;
    height: 70px;
    border-radius: 9999px;
    object-fit: cover;
    background-color: #e5e7eb;
    border: 4px solid white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    z-index: 10;
    transition: all 0.3s ease-out;
}

.student-avatar-cloud-placeholder {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    width: 70px;
    height: 70px;
    border-radius: 9999px;
    background-color: #d1d5db; /* gray-300 */
    border: 4px solid white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Fredoka One', cursive;
    font-size: 2rem;
    color: #4b5563; /* gray-600 */
    transition: all 0.3s ease-out;
}


@keyframes fade-out-down { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(20px); } }
@keyframes fade-in-up { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
.fade-out { animation: fade-out-down 0.3s ease-out forwards; }
.fade-in { animation: fade-in-up 0.3s ease-out forwards; }

.cloud-shape-1 { border-radius: 50% 60% 40% 70% / 60% 50% 70% 40%; }
.cloud-shape-2 { border-radius: 40% 70% 50% 60% / 70% 60% 40% 50%; }
.cloud-shape-3 { border-radius: 60% 50% 70% 40% / 50% 70% 50% 60%; }
.cloud-shape-4 { border-radius: 70% 40% 60% 50% / 60% 50% 70% 40%; }

.logo-select-btn:hover {
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.4); 
    transform: scale(1.1);
    background-color: #f3f4f6;
}

@keyframes count-change {
    0% { transform: scale(1.0); }
    50% { transform: scale(1.2) rotate(5deg); background-color: #FCD34D; }
    100% { transform: scale(1.0) rotate(0deg); } 
}

.counter-animate {
    animation: count-change 0.5s ease-out;
}

@keyframes float-up-down {
    0%, 100% { transform: translateY(-5px); }
    50% { transform: translateY(5px); }
}
.floating-icon {
    animation: float-up-down 3s ease-in-out infinite;
}

@keyframes title-sparkle {
    0%, 100% { filter: brightness(1); text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    50% { filter: brightness(1.5) drop-shadow(0 0 8px #FBBF24); text-shadow: 0 2px 4px rgba(251, 191, 36, 0.5); }
}
.title-sparkle {
    animation: title-sparkle 2s ease-in-out infinite;
}

/* V5.3.4 HOME TAB REVAMP */
.game-card {
    background-color: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(4px);
    padding: 2rem 3rem;
    border-radius: 1.5rem;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    border-width: 4px;
    transition: all 300ms;
}

/* V5.4.4 REVAMP: Enlarged Home Buttons & V5.6 UPDATE: Smaller Buttons */
.about-tab-switcher {
    font-family: 'Fredoka One', cursive;
    font-size: 1.25rem; /* UPDATED */
    padding: 0.75rem 1.5rem; /* UPDATED */
    transition: all 200ms;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border-bottom-width: 4px;
    border-color: rgba(107, 114, 128, 0.5);
    transform: none;
    border-radius: 9999px;
    text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
@media (min-width: 768px) {
    .about-tab-switcher {
        font-size: 1.5rem; /* UPDATED */
    }
}
.about-tab-switcher:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}
.about-tab-switcher:active {
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    transform: translateY(2px) scale(0.98);
    border-bottom-width: 2px;
}

.about-content {
    animation: pop-in 0.4s ease-out;
}

@keyframes subtle-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.03); opacity: 0.8; }
}
.login-bg-pulse {
    animation: subtle-pulse 5s ease-in-out infinite;
}

@keyframes float-star {
    0% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
    50% { transform: translate(20px, -20px) rotate(15deg); opacity: 0.9; }
    100% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
}
.floating-star {
    position: absolute;
    font-size: 3rem;
    animation: float-star 6s ease-in-out infinite alternate;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
}

.prize-box {
    position: relative;
    overflow: hidden;
}
.prize-box::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(to right, transparent 0%, rgba(255,255,255,0.5) 50%, transparent 100%);
    transform: rotate(30deg);
    animation: prize-shimmer 5s infinite;
}
@keyframes prize-shimmer {
    0% { transform: translateX(-100%) rotate(30deg); }
    100% { transform: translateX(100%) rotate(30deg); }
}

/* --- Calendar Layout Fixes --- */
.calendar-day-cell {
     height: 130px; /* Fixed height for mobile */
     transition: background-color 0.2s ease-out;
     display: flex;       /* Use Flexbox to manage vertical stack */
     flex-direction: column; 
     overflow: hidden;    /* Cut off anything that flows outside the box */
}

@media (min-width: 768px) {
    .calendar-day-cell {
        height: 170px; /* Fixed height for desktop */
    }
}

.calendar-day-cell.future-day {
    cursor: pointer;
}
.calendar-day-cell.future-day:hover {
    background-color: #E0F2FE; /* sky-100 */
}
.calendar-day-cell.day-selected {
     background-color: #BAE6FD !important; /* sky-200 */
}
.today-date-highlight {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    border-radius: 9999px;
    background-color: #38bdf8;
    color: white;
    font-weight: bold;
}

.logbook-day-btn {
    cursor: pointer;
}
.logbook-day-btn:hover {
    background-color: #E0F2FE; /* sky-100 */
}
.delete-log-btn {
    color: #f87171;
    font-weight: bold;
    font-size: 1.125rem;
    margin-left: 0.5rem;
    padding: 0 0.25rem;
}
.delete-log-btn:hover {
    color: #dc2626;
}

/* v5.5.2: Note button for award logs */
.note-log-btn {
    color: #60a5fa;
    font-weight: bold;
    font-size: 1.125rem;
    margin-left: 0.5rem;
    padding: 0 0.25rem;
}
.note-log-btn:hover {
    color: #2563eb;
}

/* FIX #2: Move Undo button to LEFT to prevent overlap with Absence controls (Right) */
.post-award-undo-btn {
    position: absolute;
    top: 0.75rem;
    left: 0.75rem; /* Changed from right: 0.75rem */
    width: 2rem;
    height: 2rem;
    background-color: #fee2e2;
    color: #dc2626;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.875rem;
    transition: all 200ms;
    transform: none;
    border-width: 2px;
    border-color: #fecaca;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    z-index: 20;
}
.post-award-undo-btn:hover {
    background-color: #fecaca;
    transform: scale(1.1);
}

.delete-event-btn {
    position: absolute;
    top: 0.25rem;
    right: 0.25rem;
    width: 1.25rem;
    height: 1.25rem;
    background-color: #fecaca;
    color: #b91c1c;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    opacity: 0.5;
    transition: all 150ms ease-out;
}
.delete-event-btn:hover {
    opacity: 1;
    background-color: #fca5a5;
}

/* Custom Minimal Scrollbar */
#calendar-grid .overflow-y-auto, #award-class-list, #adventure-log-feed, #story-history-content, #logbook-modal-content, #story-archive-list, #storybook-viewer-content, #scroll-student-roster, #attendance-chronicle-content, #trial-history-content, #schedule-manager-list, #avatar-maker-options-wrapper {
    scrollbar-width: thin; /* For Firefox */
    scrollbar-color: #A5B4FC transparent; /* For Firefox */
}
#calendar-grid .overflow-y-auto::-webkit-scrollbar, #award-class-list::-webkit-scrollbar, #adventure-log-feed::-webkit-scrollbar, #story-history-content::-webkit-scrollbar, #logbook-modal-content::-webkit-scrollbar, #story-archive-list::-webkit-scrollbar, #storybook-viewer-content::-webkit-scrollbar, #scroll-student-roster::-webkit-scrollbar, #attendance-chronicle-content::-webkit-scrollbar, #trial-history-content::-webkit-scrollbar, #schedule-manager-list::-webkit-scrollbar, #avatar-maker-options-wrapper::-webkit-scrollbar {
    width: 4px;
}
#calendar-grid .overflow-y-auto::-webkit-scrollbar-track, #award-class-list::-webkit-scrollbar-track, #adventure-log-feed::-webkit-scrollbar-track, #story-history-content::-webkit-scrollbar-track, #logbook-modal-content::-webkit-scrollbar-track, #story-archive-list::-webkit-scrollbar-track, #storybook-viewer-content::-webkit-scrollbar-track, #scroll-student-roster::-webkit-scrollbar-track, #attendance-chronicle-content::-webkit-scrollbar-track, #trial-history-content::-webkit-scrollbar-track, #schedule-manager-list::-webkit-scrollbar-track, #avatar-maker-options-wrapper::-webkit-scrollbar-track {
    background: transparent;
}
#calendar-grid .overflow-y-auto::-webkit-scrollbar-thumb, #award-class-list::-webkit-scrollbar-thumb, #adventure-log-feed::-webkit-scrollbar-thumb, #story-history-content::-webkit-scrollbar-thumb, #logbook-modal-content::-webkit-scrollbar-thumb, #story-archive-list::-webkit-scrollbar-thumb, #storybook-viewer-content::-webkit-scrollbar-thumb, #scroll-student-roster::-webkit-scrollbar-thumb, #attendance-chronicle-content::-webkit-scrollbar-thumb, #trial-history-content::-webkit-scrollbar-thumb, #schedule-manager-list::-webkit-scrollbar-thumb, #avatar-maker-options-wrapper::-webkit-scrollbar-thumb {
    background-color: #A5B4FC; /* indigo-300 */
    border-radius: 20px;
}
#calendar-grid .overflow-y-auto::-webkit-scrollbar-thumb:hover, #award-class-list::-webkit-scrollbar-thumb:hover, #adventure-log-feed::-webkit-scrollbar-thumb:hover, #story-history-content::-webkit-scrollbar-thumb:hover, #logbook-modal-content::-webkit-scrollbar-thumb:hover, #story-archive-list::-webkit-scrollbar-thumb:hover, #storybook-viewer-content::-webkit-scrollbar-thumb:hover, #scroll-student-roster::-webkit-scrollbar-thumb:hover, #attendance-chronicle-content::-webkit-scrollbar-thumb:hover, #trial-history-content::-webkit-scrollbar-thumb:hover, #schedule-manager-list::-webkit-scrollbar-thumb:hover, #avatar-maker-options-wrapper::-webkit-scrollbar-thumb:hover {
    background-color: #818CF8; /* indigo-400 */
}

#certificate-template {
    width: 800px;
    height: 600px;
    padding: 25px;
    border-width: 10px;
    border-style: solid;
    font-family: 'Georgia', serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: all 0.3s ease-in-out;
    box-sizing: border-box;
    position: relative;
}

/* --- V4.7.2: Quest Update Narrative & Award Dropdown Styles --- */
#narrative-text-container {
    font-size: 1.5rem;
    font-weight: 600;
    color: #374151;
    line-height: 1.6;
    padding: 1rem;
    background-color: #f3f4f6;
    border-radius: 0.5rem;
    min-height: 120px;
    overflow-wrap: break-word;
    white-space: normal;
    word-break: break-word;
}
@media (min-width: 768px) {
    #narrative-text-container {
        font-size: 1.875rem;
    }
}

#award-class-dropdown-panel {
    transform-origin: top;
    animation: pop-in 0.2s ease-out;
}

/* --- V5.0.0: QUEST MAP STYLES --- */
.quest-track-path {
    background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 40" width="40" height="20"><path fill="%23d1d5db" d="M 0 39 L 39 0 L 41 0 L 1 39 Z M 40 39 L 79 0 L 81 0 L 41 39 Z"></path></svg>');
    background-repeat: repeat-x;
}
.quest-track-progress {
    transition: width 1s ease-in-out;
}
.quest-track-avatar {
    transition: left 1s ease-in-out;
    filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
    z-index: 10;
    transform: translateY(-50%) translateX(-50%);
}
.quest-track-avatar span {
    display: inline-block;
    transform: scale(1.1);
}

/* V5.4.3 FIX: Quest Map Avatar Hover Effects */
@keyframes quest-avatar-jiggle {
    0%, 100% { transform: rotate(0deg) scale(1.1); }
    25% { transform: rotate(-8deg) scale(1.15); }
    75% { transform: rotate(8deg) scale(1.15); }
}
@keyframes quest-avatar-spin-pop {
    0% { transform: rotate(0deg) scale(1.1); }
    50% { transform: rotate(180deg) scale(1.25); }
    100% { transform: rotate(360deg) scale(1.1); }
}
@keyframes quest-avatar-sparkle {
    0%, 100% { transform: scale(1.1); filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3)); }
    50% { transform: scale(1.3) rotate(5deg); filter: drop-shadow(0 0 10px #FBBF24) drop-shadow(0 0 5px #FFFFFF) drop-shadow(0 4px 6px rgba(0,0,0,0.3)); }
}
.quest-track-avatar {
    user-select: none;
}
.quest-track-avatar span {
    cursor: pointer;
}
.quest-track-avatar[data-progress-tier="low"] span:hover {
    animation: quest-avatar-jiggle 0.5s ease-in-out;
}
.quest-track-avatar[data-progress-tier="mid"] span:hover {
    animation: quest-avatar-spin-pop 0.6s ease-out;
}
.quest-track-avatar[data-progress-tier="high"] span:hover {
    animation: quest-avatar-sparkle 0.8s ease-in-out;
}

/* V5.4.1 MILESTONE ENHANCEMENT */
.milestone-marker {
    width: 3.5rem;
    height: 3.5rem;
    background-color: white;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.25rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transition: all 500ms;
    transform: translateY(-50%) translateX(-50%);
    z-index: 5;
    filter: grayscale(1);
    opacity: 0.5;
    position: relative; /* For tooltip positioning */
}
.milestone-marker.achieved {
    filter: grayscale(0) drop-shadow(0 0 10px #FBBF24) drop-shadow(0 0 5px #FFFFFF);
    opacity: 1;
    transform: translateY(-50%) translateX(-50%) scale(1.25);
}

/* --- V5.3.1: MILESTONE & QUEST MAP REVAMP --- */

.quest-card {
    position: relative;
}
.quest-card:hover {
    z-index: 10;
}

/* Quest Map Tooltips & Cursor */
.milestone-marker {
    cursor: pointer;
}
/* --- V5.3.1: MILESTONE & QUEST MAP REVAMP --- */

.quest-card {
    position: relative;
}
.quest-card:hover {
    z-index: 10;
}

/* Quest Map Tooltips & Cursor */
.milestone-marker {
    cursor: pointer;
}
.milestone-tooltip {
    position: absolute;
    bottom: 140%; /* Position above the marker */
    left: 50%;
    transform: translateX(-50%) scale(0.8);
    background: linear-gradient(to bottom, #60A5FA, #3B82F6);
    color: white;
    padding: 8px 12px;
    border-radius: 12px;
    font-family: 'Fredoka One', cursive;
    text-align: center;
    width: 180px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease-out, transform 0.2s ease-out;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    border: 2px solid white;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    z-index: 20;
}
.milestone-marker:hover .milestone-tooltip {
    opacity: 1;
    transform: translateX(-50%) scale(1);
}
.milestone-tooltip::after { /* The little triangle */
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -8px;
    border-width: 8px;
    border-style: solid;
    border-color: #60A5FA transparent transparent transparent;
}
.tooltip-main-text {
    font-size: 1.1rem;
    line-height: 1.2;
}
.tooltip-sub-text {
    font-size: 0.75rem;
    opacity: 0.8;
    margin-top: 4px;
}

/* Enhanced Diamond Milestone Effects & V5.3.1 FIX */
.milestone-marker.is-diamond .milestone-tooltip {
    bottom: auto; /* Remove bottom positioning */
    top: 140%; /* Position below the marker */
}
.milestone-marker.is-diamond .milestone-tooltip::after {
    top: auto; /* Remove top positioning */
    bottom: 100%; /* Position on top of the tooltip body */
    border-color: transparent transparent #60A5FA transparent; /* Point up */
}

@keyframes diamond-achieved-glow {
    0% {
        filter: drop-shadow(0 0 8px #0CF) drop-shadow(0 0 12px #0CF) drop-shadow(0 0 20px #FFF);
        transform: translateY(-50%) translateX(-50%) scale(1.25);
    }
    50% {
        filter: drop-shadow(0 0 16px #0CF) drop-shadow(0 0 24px #0FF) drop-shadow(0 0 40px #FFF);
        transform: translateY(-50%) translateX(-50%) scale(1.35);
    }
    100% {
        filter: drop-shadow(0 0 8px #0CF) drop-shadow(0 0 12px #0CF) drop-shadow(0 0 20px #FFF);
        transform: translateY(-50%) translateX(-50%) scale(1.25);
    }
}
.milestone-marker.is-diamond.achieved {
    animation: diamond-achieved-glow 2s ease-in-out infinite;
}
.milestone-marker.is-diamond:hover .milestone-tooltip {
    background: linear-gradient(135deg, #2dd4bf, #38bdf8);
}
.milestone-marker.is-diamond:hover .milestone-tooltip::after {
    border-bottom-color: #2dd4bf; /* Match gradient */
}


/* New Award Flow Styles */
.reason-selector .reason-btn {
    transition: all 0.2s ease-out;
}
.reason-selector .reason-btn.active {
    transform: scale(1.1);
}
.reason-selector .reason-btn.active i {
    color: white;
}
.reason-selector .reason-btn[data-reason="teamwork"].active { background-color: #8b5cf6; }
.reason-selector .reason-btn[data-reason="creativity"].active { background-color: #ec4899; }
.reason-selector .reason-btn[data-reason="respect"].active { background-color: #22c55e; }
.reason-selector .reason-btn[data-reason="focus"].active { background-color: #eab308; }

.star-selector-container {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-out, opacity 0.3s ease-out, margin-top 0.3s ease-out;
    margin-top: 0;
}
.star-selector-container.visible {
    max-height: 100px;
    opacity: 1;
    margin-top: 0.75rem;
}

/* Reason Button Animation */
@keyframes spark-burst {
    0% { transform: scale(1); }
    50% { transform: scale(1.15); }
    100% { transform: scale(1); }
}
.animate-reason-select {
    animation: spark-burst 0.4s ease-out;
    position: relative;
}
.animate-reason-select::before, .animate-reason-select::after {
    content: '✨';
    position: absolute;
    top: 50%;
    left: 50%;
    opacity: 0;
    animation: spark-fly 0.5s ease-out;
    font-size: 1.5rem;
    z-index: 10;
}
.animate-reason-select::after {
    content: '⭐';
    animation-delay: 0.1s;
}
@keyframes spark-fly {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
    100% { transform: translate(var(--x, -60px), var(--y, -60px)) scale(1); opacity: 0; }
}

/* --- V5.3.2: REVAMPED STAR BUTTON EFFECTS --- */
.award-particle {
    position: fixed;
    border-radius: 50%;
    pointer-events: none;
    z-index: 1000;
    opacity: 0;
    animation: particle-fly 1s ease-out forwards;
    transform: translate(-50%, -50%); /* Center the particle on its coordinates */
}

@keyframes particle-fly {
    0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; }
    100% { transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(0); opacity: 0; }
}

.screen-flash {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: var(--flash-color);
    opacity: 0;
    z-index: 999;
    pointer-events: none;
    animation: screen-flash-anim 0.6s ease-out;
}

@keyframes screen-flash-anim {
    0% { opacity: 0; }
    20% { opacity: 0.3; }
    100% { opacity: 0; }
}

.shockwave {
    position: fixed;
    border-radius: 50%;
    transform: translate(-50%, -50%) scale(0);
    border: 3px solid var(--shockwave-color);
    opacity: 1;
    z-index: 998;
    pointer-events: none;
    animation: shockwave-anim 0.7s ease-out;
}

@keyframes shockwave-anim {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 1; width: 0px; height: 0px; }
    100% { transform: translate(-50%, -50%) scale(1); opacity: 0; width: 400px; height: 400px; }
}

/* --- NEW: STUDENT LEADERBOARD CARD REVAMP --- */
@keyframes float-leaderboard-card {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-3px); }
}
.student-leaderboard-card {
    animation: float-leaderboard-card 6s ease-in-out infinite;
}

/* --- NEW: Absence & Welcome Back Feature Styles (FIXED) --- */
.student-cloud-card .card-content-wrapper {
    transition: all 0.3s ease-out;
}
.student-cloud-card.is-absent .card-content-wrapper,
.student-cloud-card.is-absent .student-avatar-cloud,
.student-cloud-card.is-absent .student-avatar-cloud-placeholder {
    filter: grayscale(80%);
    opacity: 0.6;
}
.student-cloud-card.is-absent .reason-selector,
.student-cloud-card.is-absent .star-selector-container {
    pointer-events: none;
}

.absence-controls {
    position: absolute;
    top: 1rem;
    right: 1rem;
    display: flex;
    gap: 0.5rem;
    z-index: 20; /* Ensure buttons are on top of avatar */
}
.absence-btn {
    width: 2.5rem;
    height: 2.5rem;
    background-color: #e5e7eb;
    color: #4b5563;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.125rem;
    transition: all 200ms;
    transform: none;
}
.absence-btn:hover {
    background-color: #d1d5db;
    transform: scale(1.1);
}
@keyframes rainbow-glow {
    0%, 100% {
        background-position: 0% 50%;
        box-shadow: 0 0 8px rgba(251, 191, 36, 0.6);
    }
    50% {
        background-position: 100% 50%;
        box-shadow: 0 0 16px rgba(251, 191, 36, 0.7);
    }
}
.welcome-back-btn {
    width: 2.5rem;
    height: 2.5rem;
    color: white;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.125rem;
    transition: transform 150ms;
    background: linear-gradient(90deg, #f87171, #fb923c, #fbbf24, #4ade80, #22d3ee, #60a5fa, #c084fc);
    background-size: 400% 400%;
    animation: rainbow-glow 4s ease-in-out infinite;
}
.welcome-back-btn:hover {
    transform: scale(1.1);
}
.welcome-back-btn:active {
    transform: scale(0.9);
}

/* --- ADVENTURE LOG DIARY STYLE (WITH ANIMATION FIX) --- */
.diary-page {
    background: #FFFAF0; /* FloralWhite, like old paper */
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 8px 15px rgba(0,0,0,0.1), 0 0 0 1px #FDF5E6, 0 2px 4px rgba(0,0,0,0.1);
    border-left: 3px solid #FFDAB9; /* PeachPuff */
    position: relative;
    /* FIX 2: This is the crucial missing piece for the animation */
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.2s ease-out;
}
.diary-page.empty {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 200px;
    border-style: dashed;
    border-color: #ccc;
    background: #f9f9f9;
}
.diary-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    border-bottom: 2px dashed #FFDAB9;
    padding-bottom: 0.75rem;
    margin-bottom: 1rem;
}
.diary-date {
    font-family: 'Lora', serif;
    font-style: italic;
    font-size: 1.25rem;
    color: #8B4513; /* SaddleBrown */
}
.diary-hero {
    background-color: #fef3c7;
    color: #92400e;
    font-size: 0.875rem;
    font-weight: bold;
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
}
.diary-body {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
}
@media (min-width: 640px) {
    .diary-body {
        grid-template-columns: 200px 1fr;
    }
}
.diary-image-container {
    width: 100%;
    aspect-ratio: 1/1;
    border: 5px solid #FDF5E6; /* Linen */
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    padding: 5px;
    background-color: white;
}
.diary-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.diary-text-content {
    display: flex;
    flex-direction: column;
}
.diary-text {
    font-family: 'Lora', serif;
    font-size: 1.1rem;
    line-height: 1.7;
    color: #374151;
    flex-grow: 1;
}
.diary-note {
    background-color: #f0f9ff;
    border-left: 3px solid #60a5fa;
    padding: 0.75rem;
    margin-top: 1rem;
    font-style: italic;
}
.diary-note p { color: #1e40af; }
.diary-note-author { color: #1d4ed8; font-size: 0.75rem; font-weight: 600; margin-top: 0.25rem; display: block; }
.diary-footer {
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
}
.diary-keywords {
    font-size: 0.875rem;
    color: #6b7280;
}
.diary-keyword {
    display: inline-block;
    background-color: #f3f4f6;
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    margin-right: 0.5rem;
    margin-top: 0.25rem;
}

/* --- NEW: Quest Map Avatar Tooltip --- */
.quest-track-avatar .avatar-tooltip {
    position: absolute;
    bottom: 130%; 
    left: 50%;
    transform: translateX(-50%) scale(0.8);
    background: #374151;
    color: white;
    padding: 6px 10px;
    border-radius: 8px;
    font-family: 'Fredoka One', cursive;
    font-size: 0.9rem;
    text-align: center;
    width: max-content;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease-out, transform 0.2s ease-out;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    z-index: 20;
}
.quest-track-avatar span:hover + .avatar-tooltip {
    opacity: 1;
    transform: translateX(-50%) scale(1);
}

/* --- NEW: 100% Quest Completion Celebration --- */
@keyframes quest-complete-glow {
    0%, 100% {
        filter: drop-shadow(0 0 6px #FBBF24) drop-shadow(0 0 3px #FFFFFF);
        transform: scale(1.2);
    }
    50% {
        filter: drop-shadow(0 0 12px #FBBF24) drop-shadow(0 0 6px #FFFFFF);
        transform: scale(1.3);
    }
}
.quest-track-avatar.quest-complete span {
    animation: quest-complete-glow 2s ease-in-out infinite;
    cursor: default;
}
.quest-track-avatar.quest-complete .avatar-tooltip {
    display: none;
}

/* V5.5.0: Story Weaver Revamp */
#story-weavers-main-content {
    background: linear-gradient(to bottom, #f0f9ff, #e0f2fe);
    border-radius: 1.5rem;
    padding: 1rem;
    border: 2px solid #a5f3fc;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    transition: flex-grow 0.4s ease-in-out;
}
#story-weavers-image-container {
    width: 100%;
    aspect-ratio: 1/1;
    background-color: #e0f2fe;
    border-radius: 1rem;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px dashed #93c5fd;
    overflow: hidden;
}
#story-weavers-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
#story-weavers-text {
    font-family: 'Georgia', serif;
    font-size: 1.25rem;
    color: #1e3a8a;
    min-height: 80px;
}
#story-history-content .story-history-card, #storybook-viewer-content .story-history-card {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    background-color: white;
    border-radius: 1rem;
    border: 1px solid #e5e7eb;
}
#story-history-content .story-history-card img, #storybook-viewer-content .story-history-card img {
    width: 150px;
    height: 150px;
    object-fit: cover;
    border-radius: 0.75rem;
    flex-shrink: 0;
}
#story-history-content .story-history-card .text-content, #storybook-viewer-content .story-history-card .text-content {
    display: flex;
    flex-direction: column;
}

/* v5.5.4 Storybook Archive Styles */
.completed-storybook-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem;
    background-color: white;
    border-radius: 0.75rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border-left-width: 8px;
    transition: all 200ms;
}
.completed-storybook-item:hover {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    transform: translateY(-0.25rem);
}
.audio-controls button.playing i:before {
    content: "\f04c"; /* Font Awesome pause icon */
}

/* --- MAGICAL LOADING SCREEN --- */

/* 1. Center Star Pulse */
@keyframes load-star-pulse {
    0%, 100% { transform: scale(1); filter: drop-shadow(0 0 15px #FBBF24); }
    50% { transform: scale(1.15); filter: drop-shadow(0 0 40px #F59E0B); }
}

/* 1. Center Star - Geometric Fix */
/* 1. Center Star - Geometric Lock */
.loading-center-star {
    width: 120px !important;  /* Fixed square box */
    height: 120px !important;
    
    /* Perfect Center of the Box */
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    
    font-size: 5rem !important; /* Font fits inside box */
    color: #FBBF24 !important;
    
    animation: load-star-pulse 2s ease-in-out infinite !important;
    z-index: 10;
    margin: 0 auto !important; /* Force center if parent allows */
}

/* 2. Beautiful Glowing Ring */
.loading-simple-ring {
    position: absolute;
    /* Perfect Center */
    top: 50%;
    left: 50%;
    
    /* Size */
    width: 170px; 
    height: 170px;
    
    /* Outer Ring Style */
    border: 5px solid rgba(251, 191, 36, 0.1); /* Very Faint Track */
    border-top: 5px solid #FBBF24;             /* Solid Gold Spinner */
    border-radius: 50%;
    
    /* The Magical Glow */
    filter: drop-shadow(0 0 10px #F59E0B);
    
    z-index: 5;
    /* Animation includes centering translate to keep it locked in place */
    animation: ring-spin-center 3s linear infinite;
}

/* Inner Counter-Ring (Adds complexity and beauty) */
.loading-simple-ring::after {
    content: '';
    position: absolute;
    /* Inset by 15px to create a smaller ring inside */
    top: 15px; left: 15px; right: 15px; bottom: 15px;
    
    border: 4px solid rgba(251, 191, 36, 0.1);
    border-bottom: 4px solid #FDE047; /* Brighter Yellow/Gold */
    border-radius: 50%;
    
    /* Spin faster in the opposite direction */
    animation: ring-spin-normal 1.5s linear infinite reverse;
}

/* Keyframe for the Main Ring (Must preserve centering) */
@keyframes ring-spin-center {
    from { transform: translate(-50%, -50%) rotate(0deg); }
    to   { transform: translate(-50%, -50%) rotate(360deg); }
}

/* Keyframe for the Inner Ring (Rotates relative to parent) */
@keyframes ring-spin-normal {
    from { transform: rotate(0deg); }
    to   { transform: rotate(360deg); }
}

/* --- NEW in v6.0.0: Scholar's Scroll & Starfall Styles --- */

/* Starfall Modal Background */
@keyframes starfall-swirl {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}
.starfall-bg {
    background: radial-gradient(ellipse at center, rgba(29,78,216,0.5) 0%, rgba(30,58,138,0.8) 40%, rgba(17,24,39,1) 100%);
    animation: starfall-swirl 20s linear infinite;
}
/* Starfall Modal Icon */
@keyframes starfall-icon-pulse {
    0%, 100% { 
        transform: scale(1);
        filter: drop-shadow(0 0 10px #FBBF24) drop-shadow(0 0 20px #FFF);
    }
    50% { 
        transform: scale(1.1);
        filter: drop-shadow(0 0 20px #FBBF24) drop-shadow(0 0 40px #FFF);
    }
}
.starfall-icon-animate {
    animation: starfall-icon-pulse 2.5s ease-in-out infinite;
}

/* Scholar's Scroll Dashboard Cards */
.scroll-stat-card {
    background-color: #fffbeb; /* amber-50 */
    border-left-width: 8px;
    border-color: #f59e0b; /* amber-600 */
    padding: 1rem;
    border-radius: 0.75rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    display: flex; /* FIX #3 */
    flex-direction: column; /* FIX #3 */
    justify-content: space-between; /* FIX #3 */
    min-height: 120px; /* FIX #3 */
}
/* FIX #3: Allow scholar names to wrap */
.scroll-stat-card .font-title {
    white-space: normal;
    word-break: break-word;
    flex-grow: 1;
}

.scroll-student-row:hover {
    background-color: #f9fafb; /* gray-50 */
}

/* *** NEW: Style for optgroup labels in select dropdowns *** */
optgroup {
    font-weight: bold;
    font-style: italic;
    color: #581c87; /* purple-900 */
    background-color: #f3f4f6; /* gray-100 */
    padding: 4px;
}

/* --- NEW IN v6.1: Attendance & Overview Styles --- */

/* Attendance Chronicle */
#attendance-chronicle-content .date-header {
    position: sticky;
    top: -1px;
    background-color: #f3f4f6; /* gray-100 */
    z-index: 10;
}
.attendance-status {
    width: 1.25rem;
    height: 1.25rem;
    border-radius: 9999px;
    display: inline-block;
}
.status-present {
    background-color: #22c55e; /* green-500 */
    box-shadow: 0 0 5px #22c55e;
}
.status-absent {
    background-color: #ef4444; /* red-500 */
    box-shadow: 0 0 5px #ef4444;
}

/* --- NEW IN v6.1.2: Revamped Attendance Chronicle Modal --- */

#attendance-chronicle-content {
    overflow: auto;
}

#attendance-chronicle-content table {
    min-width: 600px; 
}

#attendance-chronicle-content th,
#attendance-chronicle-content td {
    padding: 0.75rem 0.5rem;
    border: 1px solid #e5e7eb;
    text-align: center;
    vertical-align: middle;
}

#attendance-chronicle-content th {
    background-color: #f9fafb;
    font-size: 0.875rem;
    font-weight: 600;
    color: #4b5563;
}

#attendance-chronicle-content th:first-child,
#attendance-chronicle-content td:first-child {
    text-align: left;
    position: sticky;
    left: 0;
    background-color: #f9fafb;
    z-index: 20;
}

#attendance-chronicle-content td:first-child {
    background-color: #ffffff;
    font-weight: 500;
}

#attendance-chronicle-content tbody tr:hover td,
#attendance-chronicle-content tbody tr:hover td:first-child {
    background-color: #f3f4f6;
}

.attendance-status-btn {
    width: 1.5rem;
    height: 1.5rem;
    border-radius: 9999px;
    display: inline-block;
    cursor: pointer;
    transition: all 150ms ease-out;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1), inset 0 1px 2px rgba(255,255,255,0.5);
    border: 2px solid transparent;
}

.attendance-status-btn:hover {
    transform: scale(1.2);
    border-color: #9ca3af;
}

.attendance-status-btn.status-present {
    background-color: #22c55e;
    box-shadow: 0 0 8px rgba(34, 197, 94, 0.5);
}

.attendance-status-btn.status-absent {
    background-color: #ef4444;
    box-shadow: 0 0 8px rgba(239, 68, 68, 0.5);
}

/* --- NEW: Trial History Modal Styles (FIX #3) --- */
#trial-history-modal {
    z-index: 71; /* Higher than edit modal */
}
#log-trial-modal {
    z-index: 72; /* Higher than history modal */
}

#trial-history-view-toggle .toggle-btn {
    font-family: 'Fredoka One', cursive;
    padding: 0.5rem 1.5rem;
    border-radius: 9999px;
    font-size: 1.125rem;
    color: #9A3412; /* amber-800 */
    transition: all 200ms ease-out;
    cursor: pointer;
}
#trial-history-view-toggle .toggle-btn.active-toggle {
    background-color: #F59E0B; /* amber-500 */
    color: white;
    box-shadow: 0 4px 10px rgba(245, 158, 11, 0.4);
    transform: scale(1.05);
}

.trial-history-item {
    background-color: white;
    padding: 1rem;
    border-radius: 1rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border-left-width: 6px;
    border-color: #FCD34D; /* amber-300 */
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: all 200ms ease-out;
}
.trial-history-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    border-color: #FBBF24; /* amber-400 */
}

.delete-trial-btn, .edit-trial-btn {
    opacity: 0.5;
}
.trial-history-item:hover .delete-trial-btn, .trial-history-item:hover .edit-trial-btn {
    opacity: 1;
}
.edit-trial-btn { background-color: #dbeafe; color: #1e40af; }

details.month-group {
    border: 1px solid #e5e7eb;
    border-radius: 0.75rem;
    overflow: hidden;
}
details.month-group summary {
    background-color: #f9fafb;
    border-bottom: 1px solid #e5e7eb;
}
details.month-group[open] summary {
    border-bottom-color: transparent;
}

/* FIX #1: Trial History Date Grouping */
.date-group-header {
    font-weight: 600;
    color: #4b5563; /* gray-600 */
    padding: 0.5rem;
    background-color: #f3f4f6; /* gray-100 */
    border-radius: 0.5rem;
    margin-top: 0.5rem;
}

/* --- NEW IN v6.2.2: Overview Modal Styles --- */
.overview-tab-btn {
    transition: all 150ms ease-in-out;
}

.overview-stat-card {
    background-color: #faf5ff; /* purple-50 */
    border-left-width: 6px;
    border-color: #a855f7; /* purple-600 */
    padding: 1rem;
    border-radius: 0.75rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

/* --- NEW IN v6.9.1: Avatar Maker & Display Styles --- */

/* Avatar Display (used in various places) */
.student-avatar {
    width: 40px;
    height: 40px;
    border-radius: 9999px;
    object-fit: cover;
    background-color: #e5e7eb; /* gray-200 */
    border: 2px solid white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.student-avatar.large-avatar {
    width: 48px;
    height: 48px;
}

/* Button in Student Management List */
.avatar-maker-btn, .move-student-btn {
    background-color: #dbeafe; /* blue-100 */
    color: #1e40af; /* blue-800 */
}
.avatar-maker-btn:hover, .move-student-btn:hover {
    background-color: #bfdbfe; /* blue-200 */
}
.move-student-btn { background-color: #fef9c3; color: #713f12; }
.move-student-btn:hover { background-color: #fef08a; }

/* Avatar Maker Modal */
.avatar-maker-option-pool {
    background-color: #f3f4f6; /* gray-100 */
    border-radius: 1rem;
    padding: 1rem;
    border: 2px solid #e5e7eb; /* gray-200 */
}
.avatar-maker-option-btn {
    padding: 0.5rem 1rem;
    border-radius: 9999px;
    font-weight: 600;
    cursor: pointer;
    transition: all 150ms ease-out;
    border: 2px solid transparent;
    background-color: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
.avatar-maker-option-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
.avatar-maker-option-btn.selected {
    transform: scale(1.05);
    border-color: #3b82f6; /* blue-500 */
    background-color: #dbeafe; /* blue-100 */
    color: #1e40af; /* blue-800 */
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.4);
}

#avatar-display-area {
    width: 256px;
    height: 256px;
    background-color: #e5e7eb; /* gray-200 */
    border-radius: 1.5rem;
    border: 4px dashed #9ca3af; /* gray-400 */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}
#avatar-display-area img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* --- CEREMONY FEATURE STYLES --- */

/* Pulsing Nav Button */
@keyframes ceremony-pulse {
    0%, 100% {
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.8), 0 2px 4px rgba(0,0,0,0.4);
        transform: scale(1);
    }
    50% {
        box-shadow: 0 0 30px #FBBF24, 0 0 15px #FFFFFF, 0 4px 8px rgba(0,0,0,0.4);
        transform: scale(1.05);
    }
}
.ceremony-ready-pulse {
    animation: ceremony-pulse 2s ease-in-out infinite;
}

/* Day Planner Modal Tabs */
.day-planner-tab-btn {
    transition: all 150ms ease-in-out;
}

/* Ceremony Reveal Cards */
@keyframes slide-in-from-bottom {
    from { transform: translateY(100px) scale(0.9); opacity: 0; }
    to { transform: translateY(0) scale(1); opacity: 1; }
}
@keyframes finalist-shimmer {
    0% { border-color: rgba(255, 255, 255, 0.5); box-shadow: 0 0 20px rgba(255,255,255,0.3); }
    50% { border-color: rgba(255, 255, 255, 1); box-shadow: 0 0 40px rgba(255,255,255,0.7); }
    100% { border-color: rgba(255, 255, 255, 0.5); box-shadow: 0 0 20px rgba(255,255,255,0.3); }
}
@keyframes winner-glow {
    0% { transform: scale(1.1); box-shadow: 0 0 30px #FBBF24, 0 0 15px #fff; }
    50% { transform: scale(1.15); box-shadow: 0 0 60px #FCD34D, 0 0 30px #fff; }
    100% { transform: scale(1.1); box-shadow: 0 0 30px #FBBF24, 0 0 15px #fff; }
}

/* --- CEREMONY VISUAL REVAMP (Bubbly & Bright) --- */

.ceremony-card {
    animation: slide-in-from-bottom 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; /* Bouncy entry */
    background: white;
    border: 4px solid #e5e7eb; /* Light Gray default */
    width: 340px; /* Slightly wider */
    padding: 2rem;
    border-radius: 2rem; /* Very rounded */
    text-align: center;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    transition: all 0.5s ease-in-out;
    position: relative;
    overflow: hidden;
}

/* Rank Specific Styles */
.ceremony-card.podium-1 { 
    border-color: #fbbf24; /* Amber-400 */
    background: linear-gradient(to bottom, #fffbeb, #fff7ed);
    transform: scale(1.15); 
    z-index: 20; 
    box-shadow: 0 0 40px rgba(251, 191, 36, 0.6);
}
.ceremony-card.podium-2 { 
    border-color: #94a3b8; /* Slate-400 */
    background: linear-gradient(to bottom, #f8fafc, #f1f5f9);
    z-index: 10;
}
.ceremony-card.podium-3 { 
    border-color: #fdba74; /* Orange-300 */
    background: linear-gradient(to bottom, #fff7ed, #ffedd5);
    z-index: 5;
}

/* Finalist / Mystery Card */
.ceremony-card.finalist {
    background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); /* Indigo to Violet */
    border-color: #c4b5fd;
    color: white;
    transform: scale(1);
    box-shadow: 0 0 30px rgba(124, 58, 237, 0.5);
}
.ceremony-card.finalist h3 { color: white; }

/* Animations */
@keyframes slide-in-from-bottom {
    from { transform: translateY(100px) scale(0.8); opacity: 0; }
    to { transform: translateY(0) scale(1); opacity: 1; }
}

@keyframes winner-bounce {
    0%, 100% { transform: scale(1.15) translateY(0); }
    50% { transform: scale(1.2) translateY(-10px); }
}

.ceremony-card.podium-1 {
    animation: slide-in-from-bottom 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards, winner-bounce 2s ease-in-out infinite 1s;
}

/* Confetti Animation */
#ceremony-reveal-area.confetti-active::before {
    content: '🎉';
    position: absolute;
    top: -10%; left: 10%;
    font-size: 2rem;
    animation: confetti-fall 5s linear infinite;
    animation-delay: 0s;
}
#ceremony-reveal-area.confetti-active::after {
    content: '🎊';
    position: absolute;
    top: -10%; left: 80%;
    font-size: 3rem;
    animation: confetti-fall 5s linear infinite;
    animation-delay: -2.5s;
}

@keyframes confetti-fall {
    from { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
    to { transform: translateY(110vh) rotate(720deg); opacity: 0; }
}

.ceremony-card {
    transition: all 0.5s ease-in-out;
}

.ceremony-card.podium-1 { 
    border-color: #FFD700; 
    transform: scale(1.1); 
    z-index: 10; 
    animation: winner-glow 1.5s ease-in-out infinite, slide-in-from-bottom 0.5s ease-out forwards; 
}

/* --- FINAL: Smooth Tab Change Animations --- */
main {
    position: relative;
}

@keyframes tab-fade-in {
    from { opacity: 0; }
    to   { opacity: 1; }
}

@keyframes tab-fade-out {
    from { opacity: 1; }
    to   { opacity: 0; }
}

.app-tab.tab-animate-in {
    animation: tab-fade-in 350ms ease-out forwards;
}

.app-tab.tab-animate-out {
    position: absolute; 
    top: 1.5rem;
    left: 1.5rem;
    right: 1.5rem;
    width: auto;
    animation: tab-fade-out 350ms ease-in forwards;
}

@media (max-width: 767px) {
    .app-tab.tab-animate-out {
        top: 1rem;
        left: 1rem;
        right: 1rem;
    }
}

/* FIX 3: Added animations for login/app screen transition */
@keyframes auth-fade-out {
    from { transform: scale(1); opacity: 1; }
    to { transform: scale(1.05); opacity: 0; }
}
.auth-screen-out {
    animation: auth-fade-out 0.5s ease-in forwards;
}

@keyframes app-fade-in {
    from { transform: scale(0.95); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}
.app-screen-in {
    animation: app-fade-in 0.5s ease-out forwards;
}


/* --- FIX #6: Avatar Enlargement Styles --- */
.enlargeable-avatar {
    cursor: pointer;
    transition: transform 0.2s ease-out;
}

/* FIX #5: Specific avatar hover effects */
.student-leaderboard-card .enlargeable-avatar:hover, #student-list .enlargeable-avatar:hover, #scroll-performance-chart .enlargeable-avatar:hover {
    transform: scale(1.1);
}

@keyframes cloud-avatar-wiggle {
    0%, 100% { transform: translateX(-50%) rotate(-2deg); }
    50% { transform: translateX(-50%) rotate(2deg); }
}
.student-cloud-card .enlargeable-avatar:hover {
    animation: cloud-avatar-wiggle 0.4s ease-in-out;
}


.enlarged-avatar-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100;
    opacity: 0;
    transition: opacity 0.3s ease-out;
    cursor: pointer;
}

.enlarged-avatar-image {
    position: fixed;
    border-radius: 9999px;
    border: 6px solid white;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 101;
    cursor: default;
}

/* --- FIX #10: Smooth Resizing for Idea Forge --- */
#reward-ideas-tab .grid {
    align-items: start;
    transition: align-items 0.4s ease-in-out;
}
#reward-ideas-tab .grid.story-weavers-active {
    display: flex;
    flex-direction: column;
}
@media (min-width: 768px) {
    #reward-ideas-tab .grid.story-weavers-active {
        flex-direction: row;
        align-items: stretch;
    }
}
#reward-ideas-tab .grid > div {
    transition: flex-grow 0.4s ease-in-out;
    width: 100%;
}
@media (min-width: 768px) {
    #reward-ideas-tab .grid > div {
        width: auto;
    }
}


#reward-ideas-tab .grid.story-weavers-active > div:last-child {
    flex-grow: 1;
}

/* --- FIX #2: Scholar's Scroll Performance Chart Styles --- */
.performance-chart-container {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}
.chart-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}
.chart-row .student-avatar {
    flex-shrink: 0;
}
.chart-label {
    width: 180px; /* MODIFIED: Increased from 120px to give names more space */
    font-weight: 600;
    color: #4b5563;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex-shrink: 0;
}
.chart-bar-wrapper {
    flex-grow: 1;
    background-color: #e5e7eb;
    border-radius: 9999px;
    height: 2rem;
    padding: 0.25rem;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    position: relative; /* Added for tooltip positioning */
}
@keyframes grow-bar {
    from { width: 0%; }
}
.chart-bar {
    height: 100%;
    border-radius: 9999px;
    width: 0; /* Initial width for animation */
    animation: grow-bar 1s ease-out forwards;
    transition: background-color 0.5s;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 0.75rem;
    color: white;
    font-weight: bold;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}
.chart-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: linear-gradient(45deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent);
    background-size: 20px 20px;
    opacity: 0.5;
}
/* Bar colors based on score */
.chart-bar[data-score-tier="high"] {
    background-image: linear-gradient(to right, #22c55e, #86efac);
}
.chart-bar[data-score-tier="mid"] {
    background-image: linear-gradient(to right, #eab308, #fde047);
}
.chart-bar[data-score-tier="low"] {
    background-image: linear-gradient(to right, #ef4444, #f87171);
}

/* --- NEW: Hero Stats Modal Styles --- */
@keyframes hero-avatar-float {
    0%, 100% { transform: translateY(-4px) rotate(-1deg); }
    50% { transform: translateY(4px) rotate(1deg); }
}

#hero-stats-avatar-container #hero-stats-avatar {
    animation: hero-avatar-float 6s ease-in-out infinite;
}

#hero-stats-avatar img, #hero-stats-avatar div {
    width: 100%;
    height: 100%;
    border-radius: 9999px;
    object-fit: cover;
}

.hero-stat-item {
    background-color: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.75rem;
    padding: 0.75rem 1rem;
    display: flex;
    align-items: center;
    gap: 1rem;
}
.hero-stat-item .icon {
    font-size: 1.75rem;
    width: 2.5rem;
    text-align: center;
}
.hero-stat-item .text .title {
    font-size: 0.875rem;
    font-weight: bold;
    color: #d8b4fe; /* purple-300 */
    text-transform: uppercase;
}
.hero-stat-item .text .value {
    font-size: 1.125rem;
    color: white;
    font-weight: 500;
}

/* --- NEW: CSS Rule for Hero Stats Modal Layout --- */
#hero-stats-chart-container {
    position: relative; /* Required by Chart.js for responsiveness */
    min-height: 200px;
}

/* --- NEW IN v6.4: Bulk Trial Log Styles --- */
.bulk-log-item {
    transition: all 0.2s ease-in-out;
    border: 2px solid transparent;
}
.bulk-log-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}
.bulk-log-item.absent {
    background-color: #F3F4F6;
    border-style: dashed;
    border-color: #9CA3AF;
}
.bulk-log-item.absent .student-avatar {
    filter: grayscale(100%);
    opacity: 0.6;
}
.bulk-log-item.absent .grade-input-wrapper {
    opacity: 0.4;
    pointer-events: none;
}

.toggle-absent-btn {
    transition: all 0.2s;
}
.toggle-absent-btn.is-absent {
    background-color: #EF4444;
    color: white;
}

.bulk-grade-input {
    transition: border-color 0.2s;
}
.bulk-grade-input:focus {
    border-color: #f59e0b; /* amber-500 */
    box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.2);
}

/* Attendance Column Delete Button */
.attendance-header-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
}
.delete-column-btn {
    font-size: 0.65rem;
    color: #9ca3af;
    cursor: pointer;
    padding: 2px 6px;
    border-radius: 4px;
    transition: all 0.2s;
    background-color: #f3f4f6;
}
.delete-column-btn:hover {
    color: #ef4444; /* Red */
    background-color: #fee2e2;
}

/* --- HOLIDAY CALENDAR OVERLAYS --- */

/* Base Holiday Cell */
.calendar-holiday-cell {
    position: relative;
    overflow: hidden;
    border: 2px solid transparent;
    transition: all 0.3s ease;
}

/* Christmas Theme (Candy Cane + Snow) */
.holiday-theme-christmas {
    background: repeating-linear-gradient(
        45deg,
        #FEF2F2,
        #FEF2F2 10px,
        #FEE2E2 10px,
        #FEE2E2 20px
    );
    border-color: #FECACA;
}
.holiday-theme-christmas::before {
    content: '❄️';
    position: absolute;
    font-size: 1.5rem;
    top: -10px;
    right: -5px;
    opacity: 0.6;
    animation: float-snow 3s ease-in-out infinite;
}
@keyframes float-snow {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(5px) rotate(20deg); }
}

/* Easter Theme (Spring + Eggs + Bunny) */
.holiday-theme-easter {
    background: linear-gradient(to bottom right, #F0FDF4, #FEFCE8); /* Green to Yellow */
    border-color: #BBF7D0;
}
.holiday-theme-easter::after {
    content: '🥚'; /* Egg stays at bottom right */
    position: absolute;
    bottom: 2px;
    right: 2px;
    font-size: 1.2rem;
    opacity: 0.7;
    transform: rotate(15deg);
}
.holiday-theme-easter::before {
    content: '🐰'; /* Flower changed to Bunny at top left! */
    position: absolute;
    top: 0px;
    left: 2px;
    font-size: 1.2rem;
    opacity: 0.8;
}

/* Generic Holiday */
.holiday-theme-generic {
    background-color: #F3F4F6;
    background-image: radial-gradient(#E5E7EB 1px, transparent 1px);
    background-size: 10px 10px;
}

/* Text Overlay */
.holiday-label {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-family: 'Fredoka One', cursive;
    font-size: 1.5rem;
    color: rgba(0,0,0,0.1);
    pointer-events: none;
    white-space: nowrap;
    z-index: 0;
}
.holiday-theme-christmas .holiday-label { color: rgba(220, 38, 38, 0.15); } /* Red tint */
.holiday-theme-easter .holiday-label { color: rgba(101, 163, 13, 0.15); } /* Green tint */

/* --- NEW: Missing / Makeup Work Styles --- */
.makeup-alert-container {
    background-color: #fff7ed; /* orange-50 */
    border: 2px dashed #f97316; /* orange-500 */
    border-radius: 1rem;
    padding: 1rem;
    margin-bottom: 1.5rem;
}

.makeup-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: white;
    padding: 0.75rem;
    border-radius: 0.5rem;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    border-left: 4px solid #f97316;
    margin-bottom: 0.5rem;
}

.makeup-log-btn {
    background-color: #ffedd5;
    color: #9a3412;
    font-weight: bold;
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.875rem;
    transition: all 0.2s;
}
.makeup-log-btn:hover {
    background-color: #fdba74;
    color: #7c2d12;
}

/* --- PROJECTOR MODE STYLES --- */
body.projector-mode .app-tab {
    padding: 0;
    max-width: 100vw;
    /* Add padding bottom so content isn't covered by the floating nav */
    padding-bottom: 80px; 
}

/* 1. Hide Admin Controls (Everything BUT the nav bar) */
body.projector-mode .delete-log-btn,
body.projector-mode .note-log-btn,
body.projector-mode .edit-class-btn,
body.projector-mode .delete-class-btn,
body.projector-mode .manage-students-btn,
body.projector-mode .report-class-btn, 
body.projector-mode #add-student-form,
body.projector-mode #award-class-dropdown-btn,
body.projector-mode #log-adventure-btn,
body.projector-mode #quest-assignment-btn,
body.projector-mode #attendance-chronicle-btn,
body.projector-mode #gemini-idea-btn,
body.projector-mode .absence-controls,
body.projector-mode .post-award-undo-btn,
body.projector-mode .edit-trial-btn,
body.projector-mode .delete-trial-btn,
body.projector-mode #log-trial-btn,
body.projector-mode #view-trial-history-btn {
    display: none !important;
}

/* 2. The Collapsible Navigation Bar */
body.projector-mode #bottom-nav-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 100;
    
    /* Default State: Hidden (Transparent and pushed down) */
    opacity: 0;
    transform: translateY(30px);
    
    /* Smooth Transition */
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Visuals for the floating bar */
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(8px);
    box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
    border-top: 4px solid #6366f1; /* Indigo accent line */
    padding: 10px;
}

/* 3. The Hover Trigger: Show it when mouse is near bottom */
body.projector-mode #bottom-nav-bar:hover,
body.projector-mode #bottom-nav-bar:focus-within {
    opacity: 1;
    transform: translateY(0);
}

/* 4. Invisible Hit-Area (Makes it easier to trigger the hover) */
body.projector-mode #bottom-nav-bar::before {
    content: '';
    position: absolute;
    top: -20px; /* Extends the hover zone 20px upwards */
    left: 0;
    width: 100%;
    height: 20px;
    background: transparent;
}

/* 5. Make visuals bigger for the big screen */
body.projector-mode .student-cloud-card {
    transform: scale(1.15);
    margin: 25px;
}

body.projector-mode #class-leaderboard-list .quest-card,
body.projector-mode #student-leaderboard-list .student-leaderboard-card {
    border-width: 6px;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

/* --- BOUNTY BOARD STYLES --- */
.bounty-card {
    background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
    border: 3px solid #f59e0b;
    border-radius: 1rem;
    padding: 1rem 1.5rem;
    position: relative;
    box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.2), 0 2px 4px -1px rgba(245, 158, 11, 0.1);
    display: flex;
    justify-content: space-between;
    align-items: center;
    overflow: hidden;
    animation: slide-in-from-bottom 0.5s ease-out;
}

/* Timer Bounty specific */
.bounty-card.timer-mode {
    background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
    border-color: #fbbf24;
    color: white;
}
.bounty-card.timer-mode .bounty-title { color: #fbbf24; }
.bounty-card.timer-mode .bounty-sub { color: #a5b4fc; }
.bounty-card.timer-mode.urgent {
    animation: pulse-red 1s infinite;
    border-color: #ef4444;
}
@keyframes pulse-red {
    0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
    50% { box-shadow: 0 0 20px 0 rgba(239, 68, 68, 0.7); }
}

.bounty-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 4px;
    background: linear-gradient(90deg, #fcd34d, #f59e0b, #b45309, #f59e0b, #fcd34d);
    background-size: 200% 100%;
    animation: shimmer 2s infinite linear;
}

@keyframes shimmer {
    0% { background-position: 100% 0; }
    100% { background-position: -100% 0; }
}

.bounty-timer {
    font-variant-numeric: tabular-nums;
    font-family: 'Fredoka One', cursive;
}

.bounty-card.expired {
    background: #fee2e2;
    border-color: #ef4444;
    filter: grayscale(0.8);
}

.bounty-card.completed {
    background: #ecfccb;
    border-color: #84cc16;
}

/* Projector Mode Adjustments for Bounties */
body.projector-mode .bounty-card {
    transform: scale(1.2);
    margin-bottom: 2rem;
    box-shadow: 0 10px 25px rgba(245, 158, 11, 0.4);
}
body.projector-mode .bounty-actions {
    display: none; /* Hide 'Delete'/'Claim' buttons in projector mode */
}

/* --- SHOP STYLES --- */
.shop-item-card {
    background: rgba(30, 27, 75, 0.8); /* indigo-950 */
    border: 2px solid #4f46e5; /* indigo-600 */
    border-radius: 1rem;
    overflow: hidden;
    position: relative;
    transition: all 0.3s ease;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
}

.shop-item-card:hover {
    transform: translateY(-5px);
    border-color: #fbbf24; /* amber-400 */
    box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
}

.shop-item-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-bottom: 2px solid #4f46e5;
}

.shop-buy-btn {
    width: 100%;
    padding: 0.75rem;
    background: #4f46e5;
    color: white;
    font-family: 'Fredoka One', cursive;
    transition: background 0.2s;
}
.shop-buy-btn:hover:not(:disabled) {
    background: #4338ca;
}
.shop-buy-btn:disabled {
    background: #3730a3;
    opacity: 0.5;
    cursor: not-allowed;
}

/* Inventory Grid in Hero Modal */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    gap: 0.5rem;
    margin-top: 1rem;
}
.inventory-item {
    width: 60px;
    height: 60px;
    border-radius: 0.5rem;
    border: 2px solid #e5e7eb;
    overflow: hidden;
    cursor: help;
    transition: transform 0.2s;
}
.inventory-item:hover {
    transform: scale(1.1);
    border-color: #fbbf24;
    z-index: 10;
}

/* --- COIN INDICATOR STYLES --- */
.coin-pill {
    position: absolute;
    /* Position relative to the card top-center */
    top: 0; 
    left: 50%; 
    /* Move it 40px to the right of the center (clearing the avatar) */
    margin-left: 40px; 
    transform: translateY(-50%); /* Vertically center on the card edge */
    
    background: linear-gradient(135deg, #f59e0b 0%, #b45309 100%);
    border: 2px solid white;
    padding: 0.1rem 0.4rem; /* Smaller padding */
    border-radius: 9999px;
    font-family: 'Fredoka One', cursive;
    color: white;
    font-size: 0.75rem; /* Smaller text */
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    z-index: 15;
    display: flex;
    align-items: center;
    gap: 3px;
    white-space: nowrap;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    pointer-events: none;
}

.coin-pill i {
    color: #fcd34d;
    font-size: 0.65rem; /* Smaller icon */
}

/* Animation for when coins update */
@keyframes coin-pop {
    0% { transform: translateX(-50%) scale(1); filter: brightness(1); }
    50% { transform: translateX(-50%) scale(1.3); filter: brightness(1.3); }
    100% { transform: translateX(-50%) scale(1); filter: brightness(1); }
}

.coin-update-anim {
    animation: coin-pop 0.4s ease-out;
}

/* WALLPAPER MODE STYLES */

/* 1. Enter & Exit Animations */
@keyframes expand-header { 0% { clip-path: inset(0 0 100% 0); opacity: 0; } 100% { clip-path: inset(0 0 0 0); opacity: 1; } }
@keyframes collapse-header { 0% { clip-path: inset(0 0 0 0); opacity: 1; } 100% { clip-path: inset(0 0 100% 0); opacity: 0; } }

.wallpaper-enter { animation: expand-header 1s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
.wallpaper-exit { animation: collapse-header 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }

/* 2. Celestial Animations (Day/Night) */
/* Night State Classes (Toggled via JS) */
.is-night #wall-bg-day { opacity: 0; }
.is-night #wall-bg-night { opacity: 1; }
.is-night #wall-sun { top: 110% !important; opacity: 0; } /* Sun Sets */
.is-night #wall-moon { top: 10% !important; } /* Moon Rises */
/* Night Mode Badge: Solid Dark Glass */
.is-night #wall-class-badge { 
    background-color: rgba(30, 27, 75, 0.85) !important; /* Almost solid Midnight Blue */
    border-color: rgba(165, 180, 252, 0.3) !important; /* Indigo border */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6) !important;
}

.is-night #wall-class-name { 
    color: #ffffff !important; /* Pure White Text */
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5); 
}

.is-night #wall-class-level { 
    color: #cbd5e1 !important; /* Slate Gray Text */
}

/* 3. Floating Clouds (Extended Range to fix popping) */
@keyframes float-clouds-right { 
    0% { transform: translateX(-150vw); } 
    100% { transform: translateX(150vw); } 
}
@keyframes float-clouds-left { 
    0% { transform: translateX(150vw); } 
    100% { transform: translateX(-150vw); } 
}
#dynamic-wallpaper-screen .fa-cloud { 
    display: inline-block; 
    filter: drop-shadow(0 10px 20px rgba(0,0,0,0.1)); 
    will-change: transform; /* Performance optimization */
}

@keyframes float-bob { 
    0% { transform: translateY(0) rotate(0deg); } 
    33% { transform: translateY(-15px) rotate(1deg); } 
    66% { transform: translateY(10px) rotate(-1deg); } 
    100% { transform: translateY(0) rotate(0deg); } 
}

/* Vibrant Card Themes */
.float-card-blue { 
    background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(191, 219, 254, 0.9)); 
    border: 4px solid #60A5FA; color: #1E3A8A;
}
.float-card-gold { 
    background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(253, 230, 138, 0.9)); 
    border: 4px solid #F59E0B; color: #78350F;
}
.float-card-purple { 
    background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(233, 213, 255, 0.9)); 
    border: 4px solid #A855F7; color: #581C87;
}
.float-card-green { 
    background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(187, 247, 208, 0.9)); 
    border: 4px solid #22C55E; color: #14532D;
}
.float-card-red { 
    background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(254, 202, 202, 0.9)); 
    border: 4px solid #EF4444; color: #7F1D1D;
}
.float-card-dark { 
    background: linear-gradient(135deg, rgba(31,41,55,0.95), rgba(17,24,39,0.95)); 
    border: 4px solid #FCD34D; color: white; 
}

/* 5. Center Hub */
@keyframes hub-pulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); }
    50% { box-shadow: 0 0 50px 10px rgba(255, 255, 255, 0); }
}
/* 5. Center Hub (Updated for better visibility) */
.wall-center-hub {
    /* Day Mode: Crisp White Glass */
    background: rgba(255, 255, 255, 0.25); 
    backdrop-filter: blur(12px);
    border: 2px solid rgba(255, 255, 255, 0.6);
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
}

/* Night Mode: Deep Indigo Glass (Instead of faded white) */
.is-night .wall-center-hub {
    background: rgba(15, 23, 42, 0.5) !important; /* Dark Slate */
    border-color: rgba(99, 102, 241, 0.3) !important; /* Faint Indigo Border */
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5) !important;
}

/* 6. Text Shadows */
.wall-shadow-text { filter: drop-shadow(0 4px 4px rgba(0,0,0,0.2)); }

/* --- Ceremony Updates --- */
.ceremony-card.finalist {
    /* Hide the stars/rank content initially */
    background: linear-gradient(135deg, #1f2937, #111827);
    border-color: #4b5563;
    transform: scale(0.95);
}
.ceremony-card.finalist .reveal-content {
    opacity: 0; 
}
/* Ensure text wraps nicely instead of truncating */
.ceremony-display-card h3 {
    white-space: normal; /* Allow wrapping */
    overflow: visible;
    text-overflow: clip;
    line-height: 1.1; /* Tighter lines for long names */
    height: auto;
    margin-bottom: 0.5rem;
}

/* --- DASHBOARD STYLES --- */
.dashboard-card {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(12px);
    border: 2px solid rgba(255, 255, 255, 0.8);
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.dashboard-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.15);
    border-color: #fff;
}

.stat-value {
    background: -webkit-linear-gradient(45deg, #F59E0B, #D97706);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    filter: drop-shadow(0 2px 2px rgba(0,0,0,0.1));
}

.dashboard-hero-bg {
    background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
    position: relative;
    overflow: hidden;
}
.dashboard-hero-bg::before {
    content: '';
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 60%);
    opacity: 0.6;
    animation: pulse-subtle 10s infinite;
}

/* Info Modal Tab Switchers */
.info-tab-switcher {
    font-family: 'Fredoka One', cursive;
    font-size: 1.1rem;
    padding: 0.5rem 1.5rem;
    border-radius: 9999px;
    transition: all 0.2s;
    border-bottom: 4px solid rgba(0,0,0,0.1);
}
.info-tab-switcher:active {
    transform: scale(0.95);
    border-bottom-width: 2px;
}
.info-tab-switcher.active {
    transform: scale(1.05);
}

/* Scrollbar specific for Dashboard */
.custom-scrollbar::-webkit-scrollbar { width: 8px; }
.custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.05); }
.custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
.custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

/* --- V5.7: HOME DASHBOARD REVAMP --- */

/* Staggered Animations */
@keyframes fadeInUpSmooth {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.animate-stagger-1 { animation: fadeInUpSmooth 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; opacity: 0; animation-delay: 0.1s; }
.animate-stagger-2 { animation: fadeInUpSmooth 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; opacity: 0; animation-delay: 0.2s; }
.animate-stagger-3 { animation: fadeInUpSmooth 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; opacity: 0; animation-delay: 0.3s; }
.animate-stagger-4 { animation: fadeInUpSmooth 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; opacity: 0; animation-delay: 0.4s; }

/* Dashboard Transitions */
.dashboard-transition-out {
    animation: fadeOutScale 0.3s ease-in forwards;
}
.dashboard-transition-in {
    animation: fadeInScale 0.4s ease-out forwards;
}

@keyframes fadeOutScale {
    to { opacity: 0; transform: scale(0.98); }
}
@keyframes fadeInScale {
    from { opacity: 0; transform: scale(1.02); }
    to { opacity: 1; transform: scale(1); }
}

/* Time-of-Day Text Gradients */
.text-gradient-morning {
    background: linear-gradient(to right, #f59e0b, #d97706);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}
.text-gradient-afternoon {
    background: linear-gradient(to right, #0ea5e9, #2563eb);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}
.text-gradient-evening {
    background: linear-gradient(to right, #7c3aed, #4f46e5);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}
.text-gradient-night {
    background: linear-gradient(to right, #475569, #1e293b);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

/* Locked Schedule Item */
.schedule-card-locked {
    background-color: #f9fafb;
    border-color: #e5e7eb;
    color: #9ca3af;
    cursor: default;
    opacity: 0.8;
}
.schedule-card-locked:hover {
    box-shadow: none;
    transform: none;
}

/* --- V5.8: HOME TAB POLISH --- */
/* Smooth Fade In for Home Tab */
@keyframes nice-fade-in {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.home-content-ready {
    animation: nice-fade-in 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
}

/* Master Tools Grid - Responsive & No Overflow */
.master-tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); /* Smart wrapping */
    gap: 0.75rem;
    width: 100%;
}

/* Yellow-er Star Card with Watermark */
.star-card-yellow {
    background: linear-gradient(135deg, #FFFBEB 0%, #FEF3C7 100%);
    border: 2px solid #FCD34D;
    position: relative;
    overflow: hidden;
}

.star-watermark {
    position: absolute;
    bottom: -10px;
    right: -10px;
    font-size: 8rem;
    color: rgba(251, 191, 36, 0.15); /* Faint yellow */
    transform: rotate(15deg);
    pointer-events: none;
    z-index: 0;
}

.greeting-emoji-anim {
    display: inline-block;
    animation: float-up-down 3s ease-in-out infinite;
}

/* Skeleton Loading */
.skeleton {
    background: #e5e7eb;
    background-image: linear-gradient(to right, #e5e7eb 0%, #f3f4f6 20%, #e5e7eb 40%, #e5e7eb 100%);
    background-repeat: no-repeat;
    background-size: 800px 100%; 
    animation: shimmer 1.5s infinite linear forwards;
    border-radius: 0.5rem;
}

@keyframes shimmer {
    0% { background-position: -468px 0; }
    100% { background-position: 468px 0; }
}

/* Master Tool Mini-Buttons */
.tool-btn-mini {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    padding: 0.75rem;
    border-radius: 1rem;
    background-color: #f8fafc;
    border: 1px solid #e2e8f0;
    transition: all 0.2s;
    text-align: center;
    height: 100%;
}
.tool-btn-mini:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    background-color: white;
    border-color: #cbd5e1;
}
.tool-btn-mini i {
    font-size: 1.5rem;
    margin-bottom: 0.25rem;
}
.tool-btn-mini span {
    font-size: 0.75rem;
    font-weight: 700;
    line-height: 1.1;
}

/* Glassy Stat Pill */
.glass-stat {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(4px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    padding: 0.5rem 1rem;
    border-radius: 9999px;
    color: rgba(30, 41, 59, 0.8);
    font-weight: 600;
    font-size: 0.875rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

/* --- V11.0: VIBRANT HORIZONS THEME --- */

/* 1. ANIMATIONS */
@keyframes float-cloud {
    0%, 100% { transform: translateX(0); }
    50% { transform: translateX(10px); }
}
@keyframes spin-sun {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}
@keyframes pulse-glow {
    0%, 100% { filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.6)); transform: scale(1); }
    50% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.9)); transform: scale(1.05); }
}

/* 2. LAYOUT: The 3-Row Grid */
.horizons-grid {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    gap: 1.5rem;
    padding-bottom: 2rem;
}

/* Smart Spanning */
.h-span-12 { grid-column: span 12; }
.h-span-8  { grid-column: span 12; }
.h-span-6  { grid-column: span 12; }
.h-span-4  { grid-column: span 12; }
.h-span-3  { grid-column: span 12; }

@media (min-width: 768px) {
    .h-span-6 { grid-column: span 6; }
}
@media (min-width: 1024px) {
    .h-span-8 { grid-column: span 8; }
    .h-span-4 { grid-column: span 4; }
    .h-span-3 { grid-column: span 3; }
}

/* 3. CARD BASE & COLORS */
.vibrant-card {
    border-radius: 1.75rem;
    position: relative;
    box-shadow: 0 10px 20px -5px rgba(0,0,0,0.05), 0 4px 6px -2px rgba(0,0,0,0.03);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s;
    background: white;
    border: 1px solid rgba(255,255,255,0.6);
    /* FIX: Allow dropdowns to overflow the card boundaries */
    overflow: visible !important; 
    z-index: 1;
}
.vibrant-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);
    z-index: 30; /* Ensure hovered card acts like a popup */
}

/* FIX: Date Pill Styling */
.date-pill {
    padding: 0.5rem 1.5rem;
    border-radius: 9999px;
    font-family: 'Fredoka One', cursive;
    letter-spacing: 0.05em;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

/* FIX 2 & 5: Chronicle Styling & Expansion */
.chronicle-item {
    padding: 1.25rem;
    border-radius: 1.5rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: 1px solid rgba(255,255,255,0.4);
    height: 100%;
    display: flex;
    flex-direction: column;
    cursor: pointer;
    position: relative;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    overflow: hidden;
}

.chronicle-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    z-index: 10;
}

/* Expanded State (Pop-out effect) */
.chronicle-item.expanded {
    position: absolute;
    top: 1rem;
    left: 1rem;
    right: 1rem;
    bottom: 1rem;
    height: auto;
    z-index: 50;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    transform: scale(1.02);
    overflow-y: auto;
    border-width: 2px;
}
.chronicle-item.expanded p {
    -webkit-line-clamp: unset !important; /* Show all text */
    line-clamp: unset !important;
    overflow: visible;
}

/* Gradient Themes */
.chronicle-homework { background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%); border-color: #818cf8; }
.chronicle-story { background: linear-gradient(135deg, #ecfeff 0%, #a5f3fc 100%); border-color: #22d3ee; }
.chronicle-log { background: linear-gradient(135deg, #f0fdf4 0%, #bbf7d0 100%); border-color: #4ade80; }

/* FIX 4: General Tools Hover Colors */
.tool-btn-pop[data-action="open-global-ranks"]:hover { background: #fdf4ff; color: #c026d3; border-color: #f0abfc; } /* Fuchsia */
.tool-btn-pop[data-action="create-class"]:hover { background: #f0fdf4; color: #16a34a; border-color: #86efac; } /* Green */
.tool-btn-pop[data-action="open-history"]:hover { background: #fffbeb; color: #d97706; border-color: #fcd34d; } /* Amber */
.tool-btn-pop[data-action="open-holidays"]:hover { background: #fff1f2; color: #e11d48; border-color: #fda4af; } /* Rose */
.tool-btn-pop[data-action="open-day-planner"]:hover { background: #eff6ff; color: #2563eb; border-color: #93c5fd; } /* Blue */
.tool-btn-pop[data-action="open-settings"]:hover { background: #f3f4f6; color: #4b5563; border-color: #d1d5db; } /* Gray */

/* 4. ROW 1: WEATHER WIDGET */
.weather-card {
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 1.5rem;
    position: relative;
    overflow: hidden; /* <--- KEEPS THE SPINNING EMOJI INSIDE */
    border-radius: 1.75rem; /* Ensures corners are rounded */
    isolation: isolate; /* Fixes z-index stacking issues */
}

/* FIX 3: Roster Wiggle Animation */
.roster-avatar {
    width: 2.5rem; 
    height: 2.5rem; 
    border-radius: 9999px;
    object-fit: cover;
    border: 2px solid white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    transition: transform 0.2s ease-in-out;
}
.roster-item:hover .roster-avatar {
    animation: quest-avatar-jiggle 0.5s ease-in-out;
    transform: scale(1.1);
    border-color: #818CF8;
}

/* FIX 5: Tool Button Hover Colors */
/* Default hover */
.tool-btn-pop:hover { background: white; color: #4F46E5; }

/* Specific Hovers based on target/action */
.tool-btn-pop[data-target="class-leaderboard-tab"]:hover { background: #fffbeb; color: #d97706; border-color: #fcd34d; } /* Amber */
.tool-btn-pop[data-target="student-leaderboard-tab"]:hover { background: #faf5ff; color: #7e22ce; border-color: #d8b4fe; } /* Purple */
.tool-btn-pop[data-target="award-stars-tab"]:hover { background: #fff1f2; color: #be123c; border-color: #fda4af; } /* Rose */
.tool-btn-pop[data-target="adventure-log-tab"]:hover { background: #f0fdfa; color: #0f766e; border-color: #99f6e4; } /* Teal */
.tool-btn-pop[data-target="scholars-scroll-tab"]:hover { background: #fff7ed; color: #9a3412; border-color: #fdba74; } /* Orange */
.tool-btn-pop[data-target="reward-ideas-tab"]:hover { background: #eef2ff; color: #4338ca; border-color: #a5b4fc; } /* Indigo */
.tool-btn-pop[data-action="open-report"]:hover { background: #f0fdf4; color: #15803d; border-color: #86efac; } /* Green */

/* 5. ROW 1: GREETING CARD */
.greeting-panel {
    background: white;
    padding: 2rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
    overflow: hidden; /* <--- CUTS OFF THE SQUARE MESH SHADOW */
    border-radius: 1.75rem;
}
.greeting-bg-mesh {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.1) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(236, 72, 153, 0.1) 0px, transparent 50%);
    opacity: 0.6;
    pointer-events: none;
}

/* 6. ROW 2: STAT CARDS */
.stat-card-pop {
    background: #F8FAFC;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    border: 2px solid transparent;
    transition: all 0.2s;
}
.stat-card-pop:hover {
    background: white;
    border-color: #E2E8F0;
}
.stat-value-big {
    font-family: 'Fredoka One', cursive;
    font-size: 3rem;
    line-height: 1;
    margin-bottom: 0.5rem;
}

/* 7. ROW 3: TOOLS & SCHEDULE (Revamped) */
.tools-grid-v2 {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
    gap: 1rem;
    padding: 1.5rem;
}

/* NEW: Grid Layout for Schedule (Balanced Height) */
.schedule-list-v2 {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    gap: 1rem;
    padding: 0 1.5rem 1.5rem 1.5rem;
    /* FIX: Changed from 60vh to 350px for a cleaner look */
    min-height: 350px; 
    align-content: start;
}

/* NEW: Detailed Square Class Card (Smart Text) */
.schedule-card-square {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    /* Fixed height ratio to keep them looking uniform */
    aspect-ratio: 1 / 1.1; 
    padding: 0.75rem;
    border-radius: 1.5rem;
    background: white;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    border: 3px solid transparent;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    text-align: center;
}

.schedule-card-square:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.15);
    z-index: 10;
}

/* Top: Time */
.schedule-card-square .time-pill {
    font-size: 0.6rem;
    font-weight: 800;
    padding: 0.25rem 0.6rem;
    border-radius: 99px;
    background: rgba(255,255,255,0.7);
    backdrop-filter: blur(4px);
    color: #374151;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    margin-bottom: 0.25rem;
}

/* Middle: Logo */
.schedule-card-square .logo {
    font-size: 2.25rem; /* Adjusted scale to make room for text */
    filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1));
    transition: transform 0.3s;
    line-height: 1;
    margin: 0.25rem 0;
}

.schedule-card-square:hover .logo {
    transform: scale(1.1) rotate(5deg);
}

/* Bottom: Info Stack */
.schedule-card-square .info-stack {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    /* Ensures this section takes up necessary space */
    flex-grow: 1; 
    justify-content: center;
}

/* SMART NAME TEXT: Wraps and Scales */
.schedule-card-square .name {
    font-family: 'Fredoka One', cursive;
    font-size: 0.85rem; /* Slightly smaller to fit long names */
    line-height: 1.1;
    color: #1f2937;
    width: 100%;
    
    /* Allow wrapping */
    white-space: normal; 
    word-wrap: break-word;
    
    /* Limit to 3 lines max to prevent overflow */
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.schedule-card-square .league {
    font-size: 0.6rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: rgba(0,0,0,0.5);
    background: rgba(255,255,255,0.5);
    padding: 1px 5px;
    border-radius: 4px;
    margin-top: 2px;
}

.schedule-card-square .teacher {
    font-size: 0.6rem;
    color: rgba(0,0,0,0.4);
    font-weight: 600;
    font-style: italic;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

/* Active State */
.schedule-card-square.active-lesson {
    border-color: #6366F1;
    animation: pulse-border 2s infinite;
}

/* Locked State */
.schedule-card-square.locked {
    filter: grayscale(0.9);
    opacity: 0.7;
    cursor: not-allowed;
}

/* Empty State "Camp" - Matches new height */
.schedule-empty-camp {
    grid-column: 1 / -1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #F0FDF4 0%, #DCFCE7 100%);
    border: 2px dashed #86EFAC;
    border-radius: 1.5rem;
    padding: 2rem;
    color: #166534;
    text-align: center;
    /* FIX: Set to 100% to fill the container without forcing extra scroll */
    height: 100%; 
}

/* 8. FADE ANIMATION */
.home-fade { animation: fadeIn 0.5s ease-out forwards; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* --- NEW: VIBRANT HORIZONS HOME SCREEN SELECTOR --- */
.glass-selector-wrapper {
    position: relative;
    width: 250px; /* Adjust width as needed */
    height: 44px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(4px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 9999px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    transition: all 0.2s;
}
.glass-selector-wrapper:hover {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.5);
}
.glass-selector {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0; /* Makes the original dropdown invisible */
    cursor: pointer;
}
.glass-selector-display {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    height: 100%;
    padding: 0 1rem;
    pointer-events: none; /* Allows clicks to go through to the invisible select */
}
.glass-selector-text {
    font-weight: 600;
    color: rgba(30, 41, 59, 0.8);
    font-size: 0.875rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* --- NEW: HOME DASHBOARD ROSTER STYLES --- */
.roster-card {
    display: flex;
    flex-direction: column;
}
.roster-list {
    max-height: 160px; /* Adjust this to control the scroll height */
    overflow-y: auto;
    padding-right: 0.5rem; /* Space for scrollbar */
    scrollbar-width: thin;
    scrollbar-color: #A5B4FC #E0E7FF;
}
.roster-list::-webkit-scrollbar { width: 6px; }
.roster-list::-webkit-scrollbar-track { background: #E0E7FF; }
.roster-list::-webkit-scrollbar-thumb { background-color: #A5B4FC; border-radius: 6px; }

.roster-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem;
    border-radius: 0.75rem;
    transition: background-color 0.2s;
}
.roster-item:hover {
    background-color: rgba(255, 255, 255, 0.5);
}
.roster-avatar {
    width: 2.5rem; /* 40px */
    height: 2.5rem; /* 40px */
    border-radius: 9999px;
    object-fit: cover;
    border: 2px solid white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* --- NEW: HOME DASHBOARD ROSTER STYLES --- */
.roster-card {
    display: flex;
    flex-direction: column;
}
.roster-list {
    max-height: 160px; /* Adjust this to control the scroll height */
    overflow-y: auto;
    padding-right: 0.5rem; /* Space for scrollbar */
    scrollbar-width: thin;
    scrollbar-color: #A5B4FC #E0E7FF;
}
.roster-list::-webkit-scrollbar { width: 6px; }
.roster-list::-webkit-scrollbar-track { background: #E0E7FF; }
.roster-list::-webkit-scrollbar-thumb { background-color: #A5B4FC; border-radius: 6px; }

.roster-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem;
    border-radius: 0.75rem;
    transition: background-color 0.2s;
}
.roster-item:hover {
    background-color: rgba(255, 255, 255, 0.5);
}
.roster-avatar {
    width: 2.5rem; /* 40px */
    height: 2.5rem; /* 40px */
    border-radius: 9999px;
    object-fit: cover;
    border: 2px solid white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* --- V11.0: VIBRANT HORIZONS THEME --- */

/* 1. ANIMATIONS */
@keyframes float-cloud {
    0%, 100% { transform: translateX(0); }
    50% { transform: translateX(10px); }
}
@keyframes spin-sun {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}
@keyframes pulse-glow {
    0%, 100% { filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.6)); transform: scale(1); }
    50% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.9)); transform: scale(1.05); }
}

/* 2. LAYOUT: The 3-Row Grid */
.horizons-grid {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    gap: 1.5rem;
    padding-bottom: 2rem;
}

/* Smart Spanning */
.h-span-12 { grid-column: span 12; }
.h-span-8  { grid-column: span 12; }
.h-span-6  { grid-column: span 12; }
.h-span-4  { grid-column: span 12; }
.h-span-3  { grid-column: span 12; }

@media (min-width: 768px) {
    .h-span-6 { grid-column: span 6; }
}
@media (min-width: 1024px) {
    .h-span-8 { grid-column: span 8; }
    .h-span-4 { grid-column: span 4; }
    .h-span-3 { grid-column: span 3; }
}

/* 3. CARD BASE */
.vibrant-card {
    border-radius: 1.75rem;
    overflow: hidden;
    position: relative;
    box-shadow: 0 10px 20px -5px rgba(0,0,0,0.05), 0 4px 6px -2px rgba(0,0,0,0.03);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s;
    background: white;
    border: 1px solid white;
}
.vibrant-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);
    z-index: 10;
}

/* 4. ROW 1: WEATHER WIDGET */
.weather-card {
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 1.5rem;
    position: relative;
}
/* Weather Themes */
.w-morning { background: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%); }
.w-day { background: linear-gradient(135deg, #4FACFE 0%, #00F2FE 100%); }
.w-evening { background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%); }
.w-night { background: linear-gradient(135deg, #0f172a 0%, #312e81 100%); }

.weather-sun {
    position: absolute;
    top: 1rem;   /* CHANGED: Positive value moves it INSIDE */
    right: 1rem; /* CHANGED: Positive value moves it INSIDE */
    font-size: 5rem; /* Adjusted size slightly to fit nicely */
    color: rgba(255,255,255,0.3);
    animation: spin-sun 20s linear infinite;
    z-index: 0; /* Keeps it behind the text */
}

.weather-cloud {
    position: absolute;
    bottom: 1rem; /* CHANGED: Positive value moves it INSIDE */
    left: 1rem;   /* CHANGED: Positive value moves it INSIDE */
    font-size: 4rem;
    color: rgba(255,255,255,0.4);
    animation: float-cloud 4s ease-in-out infinite;
    z-index: 0; /* Keeps it behind the text */
}

/* 5. ROW 1: GREETING CARD */
.greeting-panel {
    background: white;
    padding: 2rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
}
.greeting-bg-mesh {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.1) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(236, 72, 153, 0.1) 0px, transparent 50%);
    opacity: 0.6;
    pointer-events: none;
}

/* 6. ROW 2: STAT CARDS */
.stat-card-pop {
    background: #F8FAFC;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    border: 2px solid transparent;
    transition: all 0.2s;
}
.stat-card-pop:hover {
    background: white;
    border-color: #E2E8F0;
}
.stat-value-big {
    font-family: 'Fredoka One', cursive;
    font-size: 3rem;
    line-height: 1;
    margin-bottom: 0.5rem;
}

/* 7. ROW 3: TOOLS & SCHEDULE */
.tools-grid-v2 {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
    gap: 1rem;
    padding: 1.5rem;
}
.tool-btn-pop {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    aspect-ratio: 1;
    background: #F1F5F9;
    border-radius: 1.25rem;
    color: #64748B;
    transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    cursor: pointer;
}
.tool-btn-pop:hover {
    transform: scale(1.1);
    background: white;
    box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
    color: #4F46E5;
}
.tool-btn-pop i { font-size: 1.8rem; margin-bottom: 0.25rem; }
.tool-btn-pop span { font-size: 0.7rem; font-weight: 800; }

.schedule-list-v2 {
    max-height: 250px;
    overflow-y: auto;
    padding: 0 1.5rem 1.5rem 1.5rem;
    scrollbar-width: thin;
}
.schedule-item-v2 {
    display: flex;
    align-items: center;
    padding: 0.75rem;
    border-radius: 1rem;
    margin-bottom: 0.5rem;
    background: #F8FAFC;
    border: 1px solid transparent;
    transition: all 0.2s;
}
.schedule-item-v2:hover {
    background: white;
    border-color: #E2E8F0;
    transform: translateX(5px);
}
.schedule-item-v2.active {
    background: #EEF2FF;
    border-color: #818CF8;
}
.schedule-item-v2.locked {
    opacity: 0.6;
    filter: grayscale(1);
    cursor: not-allowed;
}

/* 8. FADE ANIMATION */
.home-fade { animation: fadeIn 0.5s ease-out forwards; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* FIX 3: Add Wiggle to Home Roster Avatars */
.vibrant-card .roster-avatar:hover {
    animation: quest-avatar-jiggle 0.5s ease-in-out;
}

#roster-modal-grid .enlargeable-avatar:hover {
    animation: quest-avatar-jiggle 0.5s ease-in-out;
}

/* Header Day/Night Cycle */
header {
    transition: background 2s ease-in-out;
}

header.header-night {
    background: linear-gradient(to right, #1e3a8a 0%, #312e81 100%) !important;
    border-bottom: 1px solid #4338ca;
}
header.header-night .cloud {
    color: rgba(255, 255, 255, 0.1);
    opacity: 0.3;
}
/* Ensure main title in header stays visible */
header.header-night h1 {
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    color: #e0e7ff;
}

/* New Weather Themes */
.w-cloudy { background: linear-gradient(135deg, #a1a1aa 0%, #71717a 100%); }
.w-rainy { background: linear-gradient(135deg, #374151 0%, #1f2937 100%); }
.w-snowy { background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%); color: #475569; }

/* Rain Effect (Widget: Organic Drops) */
.w-rainy::before {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    
    /* ASYMMETRICAL PATTERN:
       We define 3 distinct drops at random positions (20%, 60%, 90%) 
       within one tile to break the "grid" look.
       
       Shape: '3px 6px' creates a small oval "drop" instead of a long line.
    */
    background-image: 
        radial-gradient(3px 6px at 20% 30%, rgba(255,255,255,0.7), transparent),
        radial-gradient(2px 5px at 60% 80%, rgba(255,255,255,0.6), transparent),
        radial-gradient(3px 7px at 90% 5%, rgba(255,255,255,0.7), transparent);
        
    /* Large tile size spreads them out significantly */
    background-size: 120px 120px; 
    
    /* Slow, consistent speed */
    animation: rain-fall 2.5s linear infinite;
    
    opacity: 0.8;
    mix-blend-mode: overlay; 
}

@keyframes rain-fall {
    from { background-position: 0 0; }
    to { background-position: 0 120px; } /* Must match background-size height for seamless loop */
}

/* Snow Effect (Widget: Organic Emojis) */
.w-snowy::before {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    
    /* ASYMMETRICAL EMOJI PATTERN:
       We use an in-line SVG to place 3 distinct ❄️ emojis at random spots 
       (Top-Left, Bottom-Right, Top-Right) to create a sparse, natural look.
    */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Ctext x='15' y='30' font-size='20'%3E❄️%3C/text%3E%3Ctext x='70' y='90' font-size='14'%3E❄️%3C/text%3E%3Ctext x='95' y='15' font-size='24'%3E❄️%3C/text%3E%3C/svg%3E");
        
    /* Match the tile size for seamless looping */
    background-size: 120px 120px; 
    
    /* Re-use the rain animation loop, but much slower (6s) for floating snow */
    animation: rain-fall 6s linear infinite;
    
    /* Slight transparency to blend nicely */
    opacity: 0.85;
}

/* Fix for Wallpaper Quote Jitter */
#wall-quote-container {
    position: absolute;
    bottom: 2rem;
    left: 0; 
    right: 0;
    text-align: center;
    z-index: 40;
    transition: opacity 1s ease-in-out;
    opacity: 0; 
    padding: 0 1rem;
    /* This forces the browser to handle this element on a separate layer */
    will-change: transform, opacity;
    transform: translateZ(0); 
    backface-visibility: hidden;
}

/* --- NEW CEREMONY STYLES --- */

/* Background Pulse */
@keyframes pulse-slow {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.6; }
}
.animate-pulse-slow { animation: pulse-slow 8s infinite ease-in-out; }

/* Card Entrance */
@keyframes card-enter {
    0% { transform: translateY(100px) scale(0.8); opacity: 0; }
    60% { transform: translateY(-20px) scale(1.05); opacity: 1; }
    100% { transform: translateY(0) scale(1); opacity: 1; }
}
.ceremony-card-enter { animation: card-enter 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }

/* Showdown Heartbeat (Tension) */
@keyframes heartbeat {
    0% { transform: scale(1); filter: brightness(1); }
    10% { transform: scale(1.05); filter: brightness(1.2); }
    20% { transform: scale(1); filter: brightness(1); }
    100% { transform: scale(1); filter: brightness(1); }
}
.ceremony-showdown-card {
    animation: heartbeat 1.5s infinite;
    box-shadow: 0 0 50px rgba(255, 255, 255, 0.2);
}

/* Winner Reveal */
@keyframes winner-pop {
    0% { transform: scale(1); }
    50% { transform: scale(1.2) rotate(5deg); }
    100% { transform: scale(1.1) rotate(0deg); }
}
.ceremony-winner {
    animation: winner-pop 0.8s ease-out forwards;
    box-shadow: 0 0 80px rgba(251, 191, 36, 0.8); /* Gold Glow */
    border-color: #FCD34D !important;
    z-index: 50;
}

/* Base Card Style */
.ceremony-display-card {
    background: white;
    border: 6px solid #e5e7eb;
    border-radius: 2rem;
    padding: 2rem;
    width: 420px; /* Bigger width */
    max-width: 90vw; /* Safety for mobile */
    text-align: center;
    box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    position: relative;
    transition: all 0.5s ease;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* Ranks */
.rank-bronze { border-color: #cd7f32; background: linear-gradient(to bottom, #fff, #fff7ed); }
.rank-silver { border-color: #94a3b8; background: linear-gradient(to bottom, #fff, #f8fafc); }
.rank-gold { border-color: #fbbf24; background: linear-gradient(to bottom, #fff, #fffbeb); }

/* Mystery Card */
.ceremony-mystery-card {
    background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
    border: 6px solid #6366f1;
    color: white;
}

/* Confetti */
.confetti-piece {
    position: absolute;
    width: 10px; height: 10px;
    background: #ffd700;
    top: -10%;
    z-index: 20;
    animation: fall-confetti linear forwards;
}
@keyframes fall-confetti {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
}

/* WALLPAPER ENHANCEMENTS */

.glass-panel {
    backdrop-filter: blur(16px) saturate(180%);
    -webkit-backdrop-filter: blur(16px) saturate(180%);
    background-color: rgba(255, 255, 255, 0.75);
    border: 1px solid rgba(209, 213, 219, 0.3);
}

.float-card-celebration {
    /* The style is applied inline in JS for gradient, but base props here */
    color: white;
}

.float-card-white {
    background: rgba(255, 255, 255, 0.95);
    border: 4px solid #e0e7ff;
    color: #312e81;
}

.float-card-pink {
    background: linear-gradient(135deg, #fdf2f8, #fce7f3);
    border: 4px solid #f472b6;
    color: #831843;
}

@keyframes bounce-slow {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-20px); }
}
.animate-bounce-slow {
    animation: bounce-slow 3s infinite ease-in-out;
}

/* Subtle Night Mode (Twilight) */
body.night-mode {
    /* Muted Indigo to Slate Gray. 
       Looks like "evening" or "dusk" - duller than day, but not black. */
    background: linear-gradient(to bottom, #c7d2fe 0%, #cbd5e1 100%) !important;
}

/* --- TITLE MAGIC FAIRY PATROL (Safe Height & Long Rest) --- */

header h1.font-title {
    color: white !important;
    background: none !important;
    -webkit-background-clip: border-box !important;
    background-clip: border-box !important;
    text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3), 0 0 15px rgba(255, 255, 255, 0.4) !important;
    position: relative;
    display: inline-block;
}

header h1.font-title::after {
    content: '✦';
    position: absolute;
    top: 50%;
    left: -30px;
    font-size: 1.4rem;
    color: #FCD34D; /* Gold */
    
    /* Magical Glow */
    text-shadow: 
        0 0 5px #FCD34D, 
        0 0 10px #FFFFFF, 
        0 0 20px #F59E0B;
    
    opacity: 0;
    pointer-events: none;
    
    /* 
       Total Cycle: 30 seconds 
       - 0-20s: Active Flying (Out & Back)
       - 20-30s: REST (Invisible)
    */
    animation: fairy-flight-safe 30s ease-in-out infinite;
}

@keyframes fairy-flight-safe {
    /* --- OUTBOUND LEG (Left -> Right) --- */
    0% { 
        left: -40px; top: 40%; 
        opacity: 0; transform: scale(0.4) rotate(0deg); 
    }
    2% { opacity: 1; transform: scale(1) rotate(45deg); }

    /* Path 1: Arch HIGH above the text (Negative top) */
    10% { left: 15%; top: -20%; transform: scale(0.7) rotate(90deg); }
    
    /* Path 2: Dive to middle (Max 50% to stay above quote) */
    20% { left: 40%; top: 50%; transform: scale(1.1) rotate(135deg); }
    
    /* Path 3: Float up slightly */
    30% { left: 70%; top: 10%; transform: scale(0.8) rotate(180deg); }

    /* Reach Right Edge & Hover */
    35% { left: 105%; top: 30%; opacity: 1; transform: scale(1) rotate(360deg); }
    38% { left: 110%; top: 25%; opacity: 1; transform: scale(1) rotate(380deg); }

    /* --- RETURN LEG (Right -> Left - New Route) --- */
    
    /* Path 4: Dive Low first (Max 50%) */
    45% { left: 80%; top: 50%; transform: scale(1.2) rotate(300deg); }

    /* Path 5: Swoop VERY High (Loop-the-loop feel) */
    55% { left: 50%; top: -40%; transform: scale(0.5) rotate(200deg); }

    /* Path 6: Level out to center */
    62% { left: 20%; top: 20%; transform: scale(0.9) rotate(100deg); }

    /* Arrive back at start & Fade out */
    66% { left: -40px; top: 40%; opacity: 1; transform: scale(0.4) rotate(0deg); }
    68% { opacity: 0; }

    /* --- LONG REST (68% to 100% = ~10 Seconds of silence) --- */
    100% { left: -40px; opacity: 0; }
}

/* --- CEREMONY VISUAL REVAMP (Fixed & Enhanced) --- */

/* Background Spotlight Effect */
.bg-radial-gradient-spotlight {
    background: radial-gradient(circle at center, rgba(124, 58, 237, 0.4) 0%, rgba(99, 102, 241, 0.2) 40%, rgba(17, 24, 39, 0) 80%);
    animation: pulse-spotlight 6s infinite alternate;
}

@keyframes pulse-spotlight {
    0% { opacity: 0.4; transform: scale(1); filter: hue-rotate(0deg); }
    100% { opacity: 0.8; transform: scale(1.2); filter: hue-rotate(15deg); }
}

.ceremony-card {
    animation: slide-in-from-bottom 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(12px);
    border: 4px solid #e5e7eb;
    width: 360px; 
    padding: 2.5rem;
    border-radius: 2.5rem; 
    text-align: center;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 0 0 2px rgba(255,255,255,0.1);
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    /* FIX: Allow overflow so scaling effects/shadows don't clip */
    overflow: visible !important; 
}

/* Rank Specific Styles */
.ceremony-card.podium-1 { 
    border-color: #fbbf24; /* Amber-400 */
    background: linear-gradient(to bottom, #fffbeb, #fff7ed);
    transform: scale(1.15); 
    z-index: 20; 
    box-shadow: 0 0 60px rgba(251, 191, 36, 0.6), 0 0 20px rgba(255,255,255,0.5);
}
.ceremony-card.podium-2 { 
    border-color: #94a3b8; /* Slate-400 */
    background: linear-gradient(to bottom, #f8fafc, #f1f5f9);
    z-index: 10;
}
.ceremony-card.podium-3 { 
    border-color: #fdba74; /* Orange-300 */
    background: linear-gradient(to bottom, #fff7ed, #ffedd5);
    z-index: 5;
}

/* Showdown Face-Off Style */
.ceremony-card.face-off {
    background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
    border-color: #64748b;
    transform: scale(1);
    filter: grayscale(0.4) brightness(0.9); 
    z-index: 10;
}

/* Hide specific elements during face-off */
.ceremony-card.face-off .rank-badge, 
.ceremony-card.face-off .star-count {
    opacity: 0;
    filter: blur(10px);
    transition: all 0.5s ease;
}

/* Tension Shake Animation */
@keyframes shake-tension {
    0% { transform: translate(1px, 1px) rotate(0deg); }
    10% { transform: translate(-1px, -2px) rotate(-1deg); }
    20% { transform: translate(-3px, 0px) rotate(1deg); }
    30% { transform: translate(3px, 2px) rotate(0deg); }
    40% { transform: translate(1px, -1px) rotate(1deg); }
    50% { transform: translate(-1px, 2px) rotate(-1deg); }
    60% { transform: translate(-3px, 1px) rotate(0deg); }
    70% { transform: translate(3px, 1px) rotate(-1deg); }
    80% { transform: translate(-1px, -1px) rotate(1deg); }
    90% { transform: translate(1px, 2px) rotate(0deg); }
    100% { transform: translate(1px, -2px) rotate(-1deg); }
}

.ceremony-card.tension-active {
    animation: shake-tension 0.5s infinite; 
    box-shadow: 0 0 40px rgba(251, 191, 36, 0.4); 
}

/* Winner Reveal Animation */
@keyframes pop-gold {
    0% { transform: scale(1); filter: brightness(1); }
    40% { transform: scale(1.15) rotate(2deg); filter: brightness(1.2); } /* Reduced scale & rotation */
    100% { transform: scale(1.15) rotate(0deg); filter: brightness(1); }
}

/* Winner Class (Enhanced with God Rays) */
.ceremony-winner {
    animation: pop-gold 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards, winner-pulse 2s infinite ease-in-out;
    z-index: 50;
    border-color: #FCD34D !important;
    background: linear-gradient(to bottom, #fffbeb, #fff7ed) !important;
    box-shadow: 0 0 80px rgba(251, 191, 36, 0.8), 0 0 30px rgba(255,255,255,0.9);
}

/* Rays of Light Effect */
.ceremony-winner::before {
    content: '';
    position: absolute;
    top: 50%; left: 50%;
    width: 200%; height: 200%;
    background: conic-gradient(from 0deg, transparent 0deg, rgba(251, 191, 36, 0.4) 20deg, transparent 40deg, rgba(251, 191, 36, 0.4) 60deg, transparent 80deg, rgba(251, 191, 36, 0.4) 100deg, transparent 120deg, rgba(251, 191, 36, 0.4) 140deg, transparent 160deg);
    transform: translate(-50%, -50%);
    z-index: -1;
    animation: rotate-rays 10s linear infinite;
    opacity: 0.6;
    mask-image: radial-gradient(circle, black 30%, transparent 70%); /* Fade edges */
    pointer-events: none;
}

@keyframes rotate-rays {
    from { transform: translate(-50%, -50%) rotate(0deg); }
    to { transform: translate(-50%, -50%) rotate(360deg); }
}

@keyframes winner-pulse {
    0%, 100% { transform: scale(1.15) rotate(0deg); filter: brightness(1); }
    50% { transform: scale(1.18) rotate(1deg); filter: brightness(1.1) drop-shadow(0 0 10px gold); }
}

/* Reveal Helpers */
.ceremony-card.revealed-gold .rank-badge, 
.ceremony-card.revealed-silver .rank-badge,
.ceremony-card.revealed-gold .star-count, 
.ceremony-card.revealed-silver .star-count {
    opacity: 1;
    filter: blur(0);
}

/* Update 2nd Place Style (Glimmering Silver - No Gray) */
.ceremony-card.revealed-silver {
    transform: scale(1.05);
    z-index: 40;
    opacity: 1;
    filter: none; /* Removed Grayscale */
    border-color: #e2e8f0 !important; /* Silver/Slate-200 */
    background: linear-gradient(135deg, #f8fafc, #cbd5e1); /* White to Silver */
    box-shadow: 0 0 30px rgba(148, 163, 184, 0.5), 0 0 15px rgba(255,255,255,0.8); /* Silver Glow */
    animation: silver-pulse 2s infinite ease-in-out;
}

@keyframes silver-pulse {
    0%, 100% { box-shadow: 0 0 30px rgba(148, 163, 184, 0.5); border-color: #94a3b8; }
    50% { box-shadow: 0 0 50px rgba(190, 200, 220, 0.7); border-color: #cbd5e1; }
}

/* Card Entrance */
@keyframes card-enter {
    0% { transform: translateY(100px) scale(0.8); opacity: 0; }
    60% { transform: translateY(-20px) scale(1.05); opacity: 1; }
    100% { transform: translateY(0) scale(1); opacity: 1; }
}
.ceremony-card-enter { animation: card-enter 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }

/* Pulse Animation */
@keyframes pulse-slow {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.6; }
}
.animate-pulse-slow { animation: pulse-slow 8s infinite ease-in-out; }

/* Confetti */
.confetti-piece {
    position: absolute;
    width: 12px; height: 12px;
    background: #ffd700;
    top: -10%;
    z-index: 20;
    border-radius: 50%;
    animation: fall-confetti linear forwards;
}
@keyframes fall-confetti {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
}

/* Ensure Ceremony Screen covers properly */
#ceremony-screen {
    background-color: #0f172a; /* Slate-900 */
    background-image: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
}

/* --- TITLE & VS BADGE STYLES (Fixed for Emojis) --- */

#ceremony-title {
    color: white; /* Default fallback */
    filter: drop-shadow(0 0 15px rgba(245, 158, 11, 0.6));
    animation: shimmer-text 3s linear infinite;
    display: inline-block;
}

/* New: Gradient applied only to text spans */
.gradient-text {
    background: linear-gradient(to right, #fbbf24, #fcd34d, #fbbf24);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    background-size: 200% auto;
}

/* New: Emoji reset to ensure visibility */
.emoji-reset {
    color: initial !important; 
    background: none !important;
    -webkit-text-fill-color: initial !important;
    text-shadow: none;
    filter: none;
    display: inline-block; 
}

@keyframes shimmer-text {
    to { background-position: 200% center; }
}

#ceremony-subtitle {
    color: #a5b4fc;
    text-shadow: 0 0 10px rgba(165, 180, 252, 0.6);
    transition: opacity 0.5s ease-out;
}

/* Smooth Fade Out for VS Badge */
@keyframes fade-out-zoom {
    0% { opacity: 1; transform: scale(1); }
    100% { opacity: 0; transform: scale(0.1); }
}
.fade-out-fast {
    animation: fade-out-zoom 0.4s ease-in forwards;
}

/* Converge Animation for Finalists (Updated to use Transform) */
@keyframes converge-left {
    to { transform: translateX(60px) rotate(-5deg) scale(1.05); } 
}
@keyframes converge-right {
    to { transform: translateX(-60px) rotate(5deg) scale(1.05); } 
}

.converge-left {
    animation: converge-left 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}
.converge-right {
    animation: converge-right 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

/* --- BRONZE SPECIAL EFFECTS --- */

@keyframes bronze-shimmer {
    0% { box-shadow: 0 0 20px rgba(205, 127, 50, 0.4); border-color: #cd7f32; }
    50% { box-shadow: 0 0 40px rgba(255, 180, 100, 0.6); border-color: #ffcc99; transform: scale(1.02); }
    100% { box-shadow: 0 0 20px rgba(205, 127, 50, 0.4); border-color: #cd7f32; }
}

.bronze-shine {
    animation: bronze-shimmer 2s ease-in-out infinite;
    background: linear-gradient(to bottom, #fff, #fff7ed);
}

/* --- FIREWORKS --- */

.firework {
    position: absolute;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    animation: firework-explode 1s ease-out forwards;
    pointer-events: none;
    z-index: 40;
}

@keyframes firework-explode {
    0% {
        transform: scale(1);
        background: #fff;
        box-shadow: 0 0 0 0 #fff, 0 0 0 0 #fff, 0 0 0 0 #fff, 0 0 0 0 #fff, 0 0 0 0 #fff, 0 0 0 0 #fff;
        opacity: 1;
    }
    100% {
        transform: scale(0.1);
        background: transparent;
        box-shadow: 
            -120px -120px 0px -5px #ff0000, 
            120px -120px 0px -5px #ffff00, 
            120px 120px 0px -5px #00ff00, 
            -120px 120px 0px -5px #0000ff, 
            -70px -180px 0px -5px #ff00ff, 
            70px -180px 0px -5px #00ffff;
        opacity: 0;
    }
}

/* --- FINAL LEADERBOARD STYLES (NEW) --- */
.ceremony-leaderboard-container {
    width: 100%;
    max-width: 800px;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 2rem;
    padding: 2rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 20px 50px rgba(0,0,0,0.3);
    max-height: 60vh;
    overflow-y: auto;
}

.ceremony-leaderboard-item {
    display: flex;
    align-items: center;
    background: rgba(255, 255, 255, 0.9);
    margin-bottom: 0.75rem;
    padding: 1rem;
    border-radius: 1rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    transition: transform 0.2s;
    animation: slide-in-right 0.5s ease-out backwards;
}

.ceremony-leaderboard-item:hover {
    transform: scale(1.02);
}

.cli-rank {
    width: 3rem;
    height: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Fredoka One', cursive;
    font-size: 1.5rem;
    border-radius: 50%;
    margin-right: 1rem;
    color: white;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    flex-shrink: 0;
}

/* Rank Colors */
.cli-rank-1 { background: linear-gradient(135deg, #fbbf24, #d97706); box-shadow: 0 0 10px #fbbf24; font-size: 1.8rem; }
.cli-rank-2 { background: linear-gradient(135deg, #cbd5e1, #64748b); box-shadow: 0 0 10px #94a3b8; }
.cli-rank-3 { background: linear-gradient(135deg, #fb923c, #c2410c); box-shadow: 0 0 10px #fb923c; }
.cli-rank-other { background: #e2e8f0; color: #64748b; font-size: 1.25rem; }

.cli-avatar {
    width: 3.5rem;
    height: 3.5rem;
    border-radius: 50%;
    border: 3px solid white;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    object-fit: cover;
    margin-right: 1rem;
}

.cli-info {
    flex-grow: 1;
}

.cli-name {
    font-weight: 700;
    font-size: 1.2rem;
    color: #1e293b;
}

.cli-stats {
    font-size: 0.9rem;
    color: #64748b;
}

.cli-stars {
    font-family: 'Fredoka One', cursive;
    color: #d97706;
    font-size: 1.5rem;
    background: #fef3c7;
    padding: 0.25rem 0.75rem;
    border-radius: 999px;
}

@keyframes slide-in-right {
    from { opacity: 0; transform: translateX(20px); }
    to { opacity: 1; transform: translateX(0); }
}

/* --- WALLPAPER V2 STYLES --- */

@keyframes float-bob-v2 { 
    0% { transform: translateY(0) rotate(0deg); } 
    33% { transform: translateY(-15px) rotate(1deg); } 
    66% { transform: translateY(10px) rotate(-1deg); } 
    100% { transform: translateY(0) rotate(0deg); } 
}

/* Badge Pill inside Cards */
.badge-pill {
    display: inline-block;
    padding: 0.5rem 1.5rem;
    border-radius: 9999px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    font-size: 0.75rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
}

/* New Color Themes */
.float-card-indigo { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(224, 231, 255, 0.9)); border: 4px solid #6366F1; color: #312E81; }
.float-card-gold   { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(254, 243, 199, 0.9)); border: 4px solid #F59E0B; color: #78350F; }
.float-card-blue   { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(219, 234, 254, 0.9)); border: 4px solid #3B82F6; color: #1E3A8A; }
.float-card-red    { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(254, 226, 226, 0.9)); border: 4px solid #EF4444; color: #7F1D1D; }
.float-card-green  { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(220, 252, 231, 0.9)); border: 4px solid #22C55E; color: #14532D; }
.float-card-purple { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(243, 232, 255, 0.9)); border: 4px solid #A855F7; color: #581C87; }
.float-card-pink   { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(252, 231, 243, 0.9)); border: 4px solid #EC4899; color: #831843; }
.float-card-cyan   { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(207, 250, 254, 0.9)); border: 4px solid #06B6D4; color: #164E63; }
.float-card-teal   { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(204, 251, 241, 0.9)); border: 4px solid #14B8A6; color: #134E4A; }
.float-card-orange { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255, 237, 213, 0.9)); border: 4px solid #F97316; color: #7C2D12; }

/* Font Handwriting */
.font-handwriting {
    font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
    font-style: italic;
}

/* Float Slow Animation for Items */
@keyframes float-slow {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}
.animate-float-slow {
    animation: float-slow 4s ease-in-out infinite;
}

/* --- WALLPAPER V3 STYLE FIXES --- */
/* --- CONSOLIDATED WALLPAPER CARD STYLES --- */
.wallpaper-float-card {
    /* 1. Base Dimensions & Position */
    position: absolute;
    width: 400px;
    max-width: 85vw;
    
    /* 2. Visual Style (Glassmorphism) */
    padding: 2.5rem;
    border-radius: 3rem;
    background: rgba(255, 255, 255, 0.95); /* Fallback */
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    box-shadow: 
        0 25px 60px -12px rgba(0, 0, 0, 0.25), 
        0 0 0 2px rgba(255, 255, 255, 0.4) inset;
    
    /* 3. Text Legibility */
    text-shadow: 0 2px 4px rgba(0,0,0,0.4), 0 0 10px rgba(0,0,0,0.1);
    
    /* 4. Layout */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 60;

    /* 5. Positioning Logic (Safe Defaults) */
    right: auto; 
    left: 50%;
    /* Start slightly lower for entrance animation */
    transform: translateX(-50%) translateY(40px) scale(0.9);

    /* 6. Animations & Transitions */
    transition: 
        opacity 1.5s ease-in-out, 
        transform 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        
    /* Slow breathing animation (40s) */
    animation: float-bob-v2 60s ease-in-out infinite; 
}

/* Night Mode Center Hub - UPDATED FOR GLASS EFFECT */
.is-night .wall-center-hub {
    /* CHANGED: Opacity from 0.9 to 0.4 for glass effect */
    background-color: rgba(15, 23, 42, 0.4) !important; 
    
    border-color: rgba(99, 102, 241, 0.5) !important; /* Slightly softer border */
    box-shadow: 0 0 50px rgba(0, 0, 0, 0.5) !important;
    backdrop-filter: blur(20px) !important;
    -webkit-backdrop-filter: blur(20px) !important;
    color: white !important;
}

.is-night #wall-class-badge {
    background-color: rgba(255, 255, 255, 0.95) !important; /* Keep badge bright */
    border-color: white !important;
    color: #1e3a8a !important; /* Dark blue text */
}
.is-night #wall-class-name { color: #1e3a8a !important; text-shadow: none !important; }
.is-night #wall-class-level { color: #4338ca !important; }

/* Holiday Card Base */
.wallpaper-float-card {
    transition: opacity 1.5s ease-in-out, transform 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Card Themes (Ensure these exist for smart holidays) */
.float-card-red { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(254, 226, 226, 0.95)); border: 4px solid #EF4444; color: #7F1D1D; }
.float-card-green { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(220, 252, 231, 0.95)); border: 4px solid #22C55E; color: #14532D; }
.float-card-gold { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(254, 243, 199, 0.95)); border: 4px solid #F59E0B; color: #78350F; }
.float-card-blue { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(219, 234, 254, 0.95)); border: 4px solid #3B82F6; color: #1E3A8A; }
.float-card-indigo { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(224, 231, 255, 0.95)); border: 4px solid #6366F1; color: #312E81; }
.float-card-purple { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(243, 232, 255, 0.95)); border: 4px solid #A855F7; color: #581C87; }
.float-card-pink { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(252, 231, 243, 0.95)); border: 4px solid #EC4899; color: #831843; }
.float-card-cyan { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(207, 250, 254, 0.95)); border: 4px solid #06B6D4; color: #164E63; }
.float-card-teal { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(204, 251, 241, 0.95)); border: 4px solid #14B8A6; color: #134E4A; }
.float-card-orange { background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255, 237, 213, 0.95)); border: 4px solid #F97316; color: #7C2D12; }
.float-card-white { background: rgba(255, 255, 255, 0.95); border: 4px solid #E2E8F0; color: #475569; }

/* Quote Container visibility */
#wall-quote-container {
    transition: opacity 1s ease-in-out;
}

/* --- WALLPAPER LEGIBILITY FIXES --- */

/* 1. Global text shadow for all wallpaper cards to ensure white text is readable */
.wallpaper-float-card {
    text-shadow: 0 2px 4px rgba(0,0,0,0.4), 0 0 10px rgba(0,0,0,0.1);
}

/* 2. Specific darker text for light backgrounds (Gold/White cards) */
.float-card-gold h2, .float-card-gold h3, .float-card-gold p,
.float-card-white h2, .float-card-white h3, .float-card-white p {
    color: #4b5563 !important; /* Dark Gray */
    text-shadow: none !important; /* Remove shadow for dark text */
}
/* Re-add shadow for the big numbers/icons in light cards for depth */
.float-card-gold .font-title, .float-card-white .font-title {
    text-shadow: 0 2px 0px rgba(255,255,255,0.5);
}

/* --- NEW CLOCK HUB ANIMATION (Discreet Breathing) --- */
@keyframes hub-breathe {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.02); } /* Very subtle growth */
}

.hub-breathe {
    animation: hub-breathe 6s ease-in-out infinite;
    /* Ensure opacity stays full! */
    opacity: 1 !important; 
}

/* --- FINAL TITLE FIX (High Specificity) --- */
#main-app-title {
    /* 1. Reset any conflicting colors */
    color: white !important;
    background: none !important;
    -webkit-background-clip: border-box !important;
    background-clip: border-box !important;

    /* 2. The EXACT Shadow Structure from the Clock */
    /* Layer 1: Deep Depth (0 4px 6px) */
    /* Layer 2: Bright Glow (0 0 20px) */
    text-shadow: 0 4px 6px rgba(0, 0, 0, 0.6), 0 0 20px rgba(255, 255, 255, 0.8) !important;

    /* 3. Ensure the Fairy still works */
    position: relative;
    display: inline-block;
}

/* --- MINDFULNESS ANIMATION --- */
@keyframes breathing-circle {
    0%, 100% { transform: scale(0.8); opacity: 0.3; }
    50% { transform: scale(1.1); opacity: 0.6; }
}

.mindfulness-pulse {
    animation: breathing-circle 6s ease-in-out infinite; /* Slow, deep breaths */
}

/* --- SEASONAL ATMOSPHERE STYLES --- */

.seasonal-particle {
    position: absolute;
    top: -10%;
    opacity: 0.7;
    font-size: 1.5rem;
    will-change: transform;
}

/* Snow */
.seasonal-particle.snow {
    color: white;
    text-shadow: 0 0 5px white;
    font-size: 1rem;
    animation: fall-snow linear infinite;
}
@keyframes fall-snow {
    0% { transform: translateY(0) rotate(0deg); opacity: 0; }
    10% { opacity: 0.8; }
    100% { transform: translateY(110vh) rotate(360deg); opacity: 0; }
}

/* Leaves */
.seasonal-particle.leaf {
    font-size: 1.2rem;
    animation: fall-leaf ease-in-out infinite;
}
@keyframes fall-leaf {
    0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0; }
    10% { opacity: 0.8; }
    100% { transform: translateY(110vh) translateX(50px) rotate(720deg); opacity: 0; }
}

/* Petals */
.seasonal-particle.petal {
    font-size: 1rem;
    animation: float-petal ease-in-out infinite;
}
@keyframes float-petal {
    0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0; }
    20% { opacity: 0.6; }
    100% { transform: translateY(110vh) translateX(-30px) rotate(180deg); opacity: 0; }
}

/* Summer Glow Overlay */
.summer-glow {
    background: radial-gradient(circle at 50% 0%, rgba(255, 255, 0, 0.15) 0%, transparent 60%);
    animation: summer-pulse 8s infinite alternate;
}
@keyframes summer-pulse {
    from { opacity: 0.5; }
    to { opacity: 1; }
}

/* --- REAL-TIME WEATHER EFFECTS --- */

/* 1. Rain Particles */
.seasonal-particle.rain {
    width: 2px;
    height: 20px;
    background: rgba(255, 255, 255, 0.5);
    animation: fall-rain 0.6s linear infinite;
    box-shadow: 0 0 2px rgba(255, 255, 255, 0.3);
}

@keyframes fall-rain {
    0% { transform: translateY(-10vh); opacity: 0; }
    10% { opacity: 1; }
    100% { transform: translateY(110vh); opacity: 0; }
}

/* 2. Fog/Haze Layer */
.wall-fog-layer {
    position: absolute;
    inset: 0;
    background: rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(3px); /* Glassy haze */
    z-index: 5;
    pointer-events: none;
    animation: fog-drift 10s ease-in-out infinite alternate;
}

@keyframes fog-drift {
    from { opacity: 0.2; }
    to { opacity: 0.5; }
}

/* 3. Atmospheric Backgrounds (True-to-Life Weather) */

/* --- CLEAR SKY --- */
.weather-clear .fa-cloud {
    opacity: 0 !important; /* Hide clouds */
    transition: opacity 2s ease-in-out;
}
.weather-clear #wall-sun, .weather-clear #wall-moon {
    opacity: 1 !important;
    filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.6)); /* Extra glow */
}

/* --- CLOUDY / OVERCAST --- */
/* Grey-Blue Sky */
.weather-cloudy #wall-bg-day {
    background: linear-gradient(to bottom, #94a3b8 0%, #cbd5e1 100%) !important; /* Slate-400 to Slate-300 */
}
/* Dim the sun */
.weather-cloudy #wall-sun {
    opacity: 0.3 !important; 
    filter: blur(10px);
}
/* Make clouds darker/more visible */
.weather-cloudy .fa-cloud {
    color: rgba(255, 255, 255, 0.6) !important;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,0.2));
}

/* --- RAINY / STORMY --- */
/* Dark Stormy Sky */
.weather-rainy #wall-bg-day {
    background: linear-gradient(to bottom, #334155 0%, #475569 100%) !important; /* Slate-700 to Slate-600 */
}
/* HIDE THE SUN completely */
.weather-rainy #wall-sun {
    opacity: 0 !important;
    top: 150% !important; /* Move it off-screen just in case */
}
/* Dark, heavy clouds */
.weather-rainy .fa-cloud {
    color: rgba(200, 210, 220, 0.4) !important; /* Greyish tint */
}

/* --- SNOWY --- */
/* White/Grey "Winter" Sky */
.weather-snowy #wall-bg-day {
    background: linear-gradient(to bottom, #e2e8f0 0%, #f8fafc 100%) !important; /* Slate-200 to Slate-50 */
}
/* Pale, cold sun */
.weather-snowy #wall-sun {
    opacity: 0.5 !important;
    background-color: #fef3c7 !important; /* Pale yellow */
    box-shadow: 0 0 40px 20px rgba(255,255,255,0.8) !important; /* White halo */
}

/* Ensure Sun/Moon are extra visible when clear */
.weather-clear #wall-sun, .weather-clear #wall-moon {
    opacity: 1 !important;
    filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.5));
}

/* --- LOADING TEXT FIX --- */

/* 1. Define the Animation Keyframes */
@keyframes load-text-breathe {
    0%, 100% { 
        opacity: 0.8; 
        transform: scale(1); 
        text-shadow: 0 0 10px rgba(251, 191, 36, 0.3);
    }
    50% { 
        opacity: 1; 
        transform: scale(1.05); 
        text-shadow: 0 0 25px rgba(251, 191, 36, 0.8);
    }
}

/* 4. Beautiful Loading Text (Perfectly Centered) */
.loading-text {
    /* Position */
    margin-top: 3rem !important;
    width: 100% !important;
    
    /* Typography */
    font-family: 'Fredoka One', cursive !important;
    font-size: 2.5rem !important;
    text-transform: uppercase !important;
    
    /* Centering Fix */
    text-align: center !important;
    letter-spacing: 0.3em !important; 
    /* THIS IS THE FIX: Add padding-left equal to letter-spacing to balance the visual center */
    padding-left: 0.3em !important; 
    
    /* Colors */
    color: #FBBF24 !important;
    text-shadow: 0 2px 10px rgba(251, 191, 36, 0.4);
    
    /* Animation */
    animation: load-text-breathe 2.5s ease-in-out infinite alternate !important;
}

/* Stormy Weather Header */
header.header-stormy {
    animation: storm-flash 5s infinite;
}

@keyframes storm-flash {
    0%, 90%, 100% { filter: brightness(1); }
    92% { filter: brightness(2) contrast(1.2); } /* Flash */
    94% { filter: brightness(1); }
    96% { filter: brightness(1.5); } /* Aftershock */
}

/* Stormy Wallpaper Background */
.w-stormy #wall-bg-day {
    background: linear-gradient(to bottom, #1e1b4b 0%, #312e81 100%) !important;
}
.w-stormy #wall-sun {
    display: none;
}
.w-stormy .fa-cloud {
    color: #4b5563 !important;
    animation-duration: 20s !important; /* Fast moving clouds */
}
/* Rain + Thunder Overlay */
.w-stormy::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background-image: radial-gradient(2px 10px at 20% 30%, rgba(255,255,255,0.6), transparent),
                      radial-gradient(2px 10px at 60% 80%, rgba(255,255,255,0.6), transparent);
    background-size: 120px 120px;
    animation: rain-fall 0.4s linear infinite; /* Very fast rain */
    opacity: 0.6;
    z-index: 1;
}
.w-stormy::after {
    content: '';
    position: absolute;
    inset: 0;
    background: white;
    opacity: 0;
    z-index: 2;
    animation: storm-flash-overlay 8s infinite;
}
@keyframes storm-flash-overlay {
    92% { opacity: 0.3; }
    93% { opacity: 0; }
    94% { opacity: 0.1; }
    95% { opacity: 0; }
}

/* --- WEATHER STATES (Header & Widget) --- */

/* --- STORMY WEATHER EFFECTS (Calm & Non-Distracting) --- */

/* 1. Header Container Config */
header.header-stormy {
    background: linear-gradient(to right, #374151 0%, #1f2937 100%) !important;
    position: relative;
    overflow: hidden !important; 
}

/* 2. Widget Container Config */
.w-stormy { 
    background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%) !important; 
    color: white; 
    position: relative;
    overflow: hidden !important; 
    border-radius: 1.75rem; 
}

.w-stormy #wall-sun { display: none; }

/* Dark Clouds - SLOWED DOWN */
.w-stormy .fa-cloud {
    color: #4b5563 !important; 
    /* Changed from 20s to 60s for a slow, ominous drift */
    animation-duration: 60s !important; 
}

/* 3. The "Nice" Asymmetrical Rain Layer (Full Coverage & Slow) */
.w-stormy::before, header.header-stormy::before {
    content: '';
    position: absolute;
    
    /* Massive size to cover rotation gaps */
    top: -50vh;
    left: -50vw;
    width: 200vw;
    height: 200vh;
    
    /* Nice Asymmetrical Raindrops */
    background-image: 
        radial-gradient(2px 9px at 10% 10%, rgba(255,255,255,0.6), transparent),
        radial-gradient(2px 9px at 25% 60%, rgba(255,255,255,0.5), transparent),
        radial-gradient(2px 9px at 50% 20%, rgba(255,255,255,0.6), transparent),
        radial-gradient(2px 9px at 75% 80%, rgba(255,255,255,0.5), transparent),
        radial-gradient(2px 9px at 90% 40%, rgba(255,255,255,0.6), transparent);
        
    background-size: 100px 100px; 
    
    /* CHANGED: Slowed to 2.5s for a gentle heavy rain, not a blur */
    animation: storm-rain-fall 2.5s linear infinite; 
    
    transform: rotate(15deg); 
    opacity: 0.6;
    z-index: 1;
    pointer-events: none;
}

/* De-synchronize Header */
header.header-stormy::before {
    animation-delay: -1.2s;
}

@keyframes storm-rain-fall {
    from { background-position: 0 0; }
    to { background-position: 0 100px; } 
}

/* 4. Thunder Flash Overlay (Subtle) */
.w-stormy::after, header.header-stormy::after {
    content: '';
    position: absolute;
    inset: 0;
    background: white;
    opacity: 0;
    z-index: 5;
    pointer-events: none;
    animation: thunder-flash 10s infinite; /* Less frequent flashes */
}

header.header-stormy::after {
    animation-delay: 4s;
}

@keyframes thunder-flash {
    0%, 92%, 100% { opacity: 0; }
    93% { opacity: 0.2; } /* Very soft flash, not blinding */
    94% { opacity: 0; }
    95% { opacity: 0.1; } 
    96% { opacity: 0; }
}

/* 2. RAINY */
header.header-rainy {
    background: linear-gradient(to right, #4b5563 0%, #374151 100%) !important;
}
/* Rain Overlay */
.w-rainy::before, header.header-rainy::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background-image: 
        radial-gradient(2px 10px at 20% 30%, rgba(255,255,255,0.4), transparent),
        radial-gradient(2px 10px at 50% 60%, rgba(255,255,255,0.4), transparent);
    background-size: 100px 100px;
    animation: rain-fall 0.8s linear infinite; /* Normal Rain */
    opacity: 0.6;
    z-index: 1;
    pointer-events: none;
}
@keyframes rain-fall {
    from { background-position: 0 0; }
    to { background-position: 0 120px; }
}


/* 3. SNOWY */
header.header-snowy {
    background: linear-gradient(to right, #cbd5e1 0%, #94a3b8 100%) !important;
}
/* Snow Overlay */
.w-snowy::before, header.header-snowy::before {
    content: '❄️';
    position: absolute;
    top: -20px; left: 10%;
    color: rgba(255,255,255,0.6);
    text-shadow: 50vw 0 0 rgba(255,255,255,0.6), 10vw 20vh 0 rgba(255,255,255,0.6), 60vw 40vh 0 rgba(255,255,255,0.6);
    font-size: 1rem;
    animation: snow-fall 10s linear infinite;
    z-index: 1;
    pointer-events: none;
}
@keyframes snow-fall {
    0% { transform: translateY(0); }
    100% { transform: translateY(100vh); }
}


/* 4. CLOUDY */
header.header-cloudy {
    background: linear-gradient(to right, #94a3b8 0%, #64748b 100%) !important;
}
/* Moving Clouds Overlay */
header.header-cloudy::after {
    content: '☁️';
    font-size: 8rem;
    position: absolute;
    top: 20%; left: -20%;
    opacity: 0.2;
    animation: cloud-pass 40s linear infinite;
}
@keyframes cloud-pass {
    0% { transform: translateX(0); }
    100% { transform: translateX(120vw); }
}

/* --- WALLPAPER WEATHER STATES (Day & Night) --- */

/* 1. STORMY WALLPAPER */
.weather-stormy #wall-bg-day {
    background: linear-gradient(to bottom, #1e1b4b 0%, #312e81 100%) !important; /* Dark Blue Day */
}
.weather-stormy #wall-bg-night {
    /* Pitch black to deep midnight purple */
    background: linear-gradient(to bottom, #020617 0%, #1e1b4b 100%) !important; 
}
.weather-stormy #wall-sun { display: none; }

.weather-stormy .fa-cloud {
    color: #4b5563 !important; /* Dark Grey */
    animation-duration: 120s !important; /* Very Slow Drift */
}
/* Thunder Flash Overlay */
.weather-stormy::after {
    content: '';
    position: absolute;
    inset: 0;
    background: white;
    opacity: 0;
    z-index: 50; 
    pointer-events: none;
    animation: thunder-flash 10s infinite;
}

/* 2. RAINY WALLPAPER */
.weather-rainy #wall-bg-day {
    background: linear-gradient(to bottom, #334155 0%, #475569 100%) !important; /* Grey-Blue */
}
.weather-rainy #wall-bg-night {
    background: linear-gradient(to bottom, #0f172a 0%, #1e293b 100%) !important; /* Dark Slate Night */
}
.weather-rainy #wall-sun { opacity: 0 !important; }

.weather-rainy .fa-cloud {
    color: #64748b !important; /* Grey Clouds */
    animation-duration: 100s !important;
}

/* 3. SNOWY WALLPAPER */
.weather-snowy #wall-bg-day {
    background: linear-gradient(to bottom, #e2e8f0 0%, #f8fafc 100%) !important; /* White-Grey */
}
.weather-snowy #wall-bg-night {
    background: linear-gradient(to bottom, #1e293b 0%, #334155 100%) !important; /* Cold Blue Night */
}
.weather-snowy #wall-sun {
    opacity: 0.3 !important;
    background-color: #fef3c7 !important; 
    box-shadow: 0 0 40px 20px rgba(255,255,255,0.8) !important;
}
.weather-snowy .fa-cloud {
    color: #cbd5e1 !important; /* Light Grey */
    animation-duration: 150s !important;
}

/* 4. CLOUDY WALLPAPER */
.weather-cloudy #wall-bg-day {
    background: linear-gradient(to bottom, #94a3b8 0%, #cbd5e1 100%) !important;
}
.weather-cloudy #wall-bg-night {
    background: linear-gradient(to bottom, #172554 0%, #1e3a8a 100%) !important; /* Cloudy Night Blue */
}
.weather-cloudy #wall-sun {
    opacity: 0.4 !important;
    filter: blur(8px);
}
.weather-cloudy .fa-cloud {
    color: #94a3b8 !important;
    animation-duration: 120s !important;
}

/* 5. CLEAR WALLPAPER */
/* Uses default gradients defined in HTML/JS, just ensuring sun visibility */
.weather-clear #wall-sun {
    opacity: 1 !important;
    filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.6));
}
.weather-clear .fa-cloud {
    opacity: 0.4 !important; /* Faint clouds */
    animation-duration: 180s !important; /* Extremely slow */
}

/* --- WALLPAPER WEATHER STATES (Day & Night) --- */

/* 1. STORMY WALLPAPER */
.weather-stormy #wall-bg-day {
    background: linear-gradient(to bottom, #1e1b4b 0%, #312e81 100%) !important; /* Dark Blue Day */
}
.weather-stormy #wall-bg-night {
    /* Pitch black to deep midnight purple */
    background: linear-gradient(to bottom, #020617 0%, #1e1b4b 100%) !important; 
}
.weather-stormy #wall-sun, .weather-stormy #wall-moon { display: none !important; }

.weather-stormy .fa-cloud {
    color: #4b5563 !important; /* Dark Grey */
    animation-duration: 120s !important; /* Very Slow Drift */
}
/* Thunder Flash Overlay */
.weather-stormy::after {
    content: '';
    position: absolute;
    inset: 0;
    background: white;
    opacity: 0;
    z-index: 50; 
    pointer-events: none;
    animation: thunder-flash 10s infinite;
}

@keyframes thunder-flash {
    0%, 92%, 100% { opacity: 0; }
    93% { opacity: 0.2; } /* Very soft flash, not blinding */
    94% { opacity: 0; }
    95% { opacity: 0.1; } 
    96% { opacity: 0; }
}

/* 2. RAINY WALLPAPER */
.weather-rainy #wall-bg-day {
    background: linear-gradient(to bottom, #334155 0%, #475569 100%) !important; /* Grey-Blue */
}
.weather-rainy #wall-bg-night {
    background: linear-gradient(to bottom, #0f172a 0%, #1e293b 100%) !important; /* Dark Slate Night */
}
.weather-rainy #wall-sun, .weather-rainy #wall-moon { display: none !important; }

.weather-rainy .fa-cloud {
    color: #64748b !important; /* Grey Clouds */
    animation-duration: 100s !important;
}
