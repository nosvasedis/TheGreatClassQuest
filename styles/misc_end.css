/* --- TASK 7: SHOP CONFIRMATION MODAL --- */
@keyframes fade-in-modal {
    from { opacity: 0; backdrop-filter: blur(0); }
    to { opacity: 1; backdrop-filter: blur(4px); }
}

.animate-fade-in {
    animation: fade-in-modal 0.3s ease-out forwards;
}

/* Special 2x Star Day Glow Effect */
.star-day-glow {
    position: relative;
    overflow: hidden;
}

.star-day-glow::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
        to right,
        transparent,
        rgba(255, 255, 255, 0.4),
        transparent
    );
    transform: rotate(30deg);
    animation: star-shimmer 3s infinite;
}

@keyframes star-shimmer {
    0% { transform: translateX(-150%) rotate(30deg); }
    100% { transform: translateX(150%) rotate(30deg); }
}

@keyframes bounce-slow {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-4px); }
}
.animate-bounce-slow {
    animation: bounce-slow 2s infinite ease-in-out;
}

/* Reigning Hero Special Card */
.reigning-hero-card {
    border: 4px solid #FBBF24 !important; /* Gold Border */
    box-shadow: 0 0 25px rgba(251, 191, 36, 0.6), 0 10px 15px -3px rgba(0, 0, 0, 0.1) !important;
    transform: scale(1.05);
}

.hero-crown-badge {
    position: absolute;
    top: -45px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 3rem;
    filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.8));
    z-index: 30;
    animation: crown-bounce 2s infinite ease-in-out;
}

@keyframes crown-bounce {
    0%, 100% { transform: translateX(-50%) translateY(0) rotate(0); }
    50% { transform: translateX(-50%) translateY(-10px) rotate(5deg); }
}

/* Reigning Hero Visuals - Subtle & Small */
.reigning-hero-card {
    border: 4px solid #FBBF24 !important;
    box-shadow: 0 0 30px rgba(251, 191, 36, 0.3), 0 10px 15px -3px rgba(0, 0, 0, 0.1) !important;
}

.hero-crown-badge {
    position: absolute;
    /* This sits right on the top curve of the avatar */
    top: -42px; 
    left: 50%;
    transform: translateX(-50%);
    font-size: 1.8rem; /* Shrunk from 3.5rem */
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
    z-index: 50;
    animation: crown-shimmer 3s infinite ease-in-out;
    pointer-events: none;
}

@keyframes crown-shimmer {
    0%, 100% { transform: translateX(-50%) translateY(0) rotate(-5deg); filter: brightness(1); }
    50% { transform: translateX(-50%) translateY(-3px) rotate(5deg); filter: brightness(1.3) drop-shadow(0 0 10px gold); }
}

#hall-of-heroes-btn:not(:disabled) {
    box-shadow: 0 4px 15px rgba(244, 63, 94, 0.4);
    border-bottom: 4px solid #9f1239; /* Deep dark red edge */
}

#hall-of-heroes-btn:active:not(:disabled) {
    border-bottom-width: 0;
    transform: translateY(4px);
}

#wall-timer-overlay {
    position: fixed !important;
    bottom: 40px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    z-index: 1000 !important;
}

/* --- LEAGUE MAP STYLES (FIXED LAYOUT) --- */

.league-map-wrapper {
    position: relative;
    width: 100%;
    height: 0; /* Let padding define height */
    padding-top: 56.25%; /* Force 16:9 Aspect Ratio (9/16 = 0.5625) */
    background-color: #1e293b;
    border: 4px solid #fff;
    border-radius: 1.5rem;
    overflow: hidden; /* Clips content to rounded corners */
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
    isolation: isolate;
}

.league-map-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    /* YOUR FIREBASE IMAGE */
    background-image: url('https://firebasestorage.googleapis.com/v0/b/the-great-class-quest.firebasestorage.app/o/assets%2Fleague_map.png?alt=media&token=d7b28f16-9f88-4f5e-ad98-a9fdb3838f57'); 
    background-size: 100% 100%;
    background-position: center;
    z-index: 1; /* Background Layer */
}

.league-map-svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2; /* Path Layer (Above Image) */
    pointer-events: none; /* Let clicks pass through to labels */
}

.map-path-line {
    fill: none;
    stroke: rgba(255, 255, 255, 0.5);
    stroke-width: 2;
    stroke-dasharray: 6, 6; /* Dotted line */
    filter: drop-shadow(0 2px 2px rgba(0,0,0,0.5));
}

/* --- INTERACTIVE ZONE LABELS --- */
.map-zone-label {
    position: absolute;
    font-family: 'Fredoka One', cursive;
    text-shadow: 0 2px 0 rgba(0,0,0,0.8), 0 0 10px rgba(0,0,0,0.8);
    font-size: 1.1rem; /* Base size */
    text-align: center;
    transform: translate(-50%, -50%);
    cursor: pointer;
    transition: transform 0.2s;
    pointer-events: auto;
    z-index: 30; /* Above SVG */
    
    background: rgba(0,0,0,0.4);
    padding: 0.25rem 0.75rem;
    border-radius: 99px;
    border: 1px solid rgba(255,255,255,0.4);
    color: white;
}
/* Responsive Font Sizing for Mobile */
@media (max-width: 640px) {
    .map-zone-label { font-size: 0.8rem; padding: 0.15rem 0.5rem; }
}

.map-zone-label:hover {
    transform: translate(-50%, -50%) scale(1.15);
    background: rgba(255,255,255,0.2);
    border-color: white;
    z-index: 40;
}

/* --- AVATAR PINS --- */
.league-map-avatar {
    position: absolute;
    width: 48px;
    height: 48px;
    transform: translate(-50%, -100%); /* Pin Point Anchor */
    z-index: 10;
    cursor: pointer;
    transition: all 0.5s ease-in-out;
    filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
}
@media (max-width: 640px) {
    .league-map-avatar { width: 36px; height: 36px; } /* Smaller on mobile */
}

.league-map-avatar:hover { z-index: 50; transform: translate(-50%, -110%) scale(1.2); }

.pin-head {
    width: 100%; height: 100%;
    background: white; border-radius: 50%; border: 3px solid white;
    display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
}
@media (max-width: 640px) { .pin-head { font-size: 1rem; border-width: 2px; } }

.pin-point {
    position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%);
    width: 0; height: 0; 
    border-left: 8px solid transparent; border-right: 8px solid transparent; border-top: 12px solid white;
}
.league-map-avatar.is-leader .pin-head { border-color: #FCD34D; box-shadow: 0 0 15px #FCD34D; animation: bounce-gentle 2s infinite; }

/* Colors */
.pin-color-0 { border-color: #ef4444; } .pin-color-0.pin-point { border-top-color: #ef4444; }
.pin-color-1 { border-color: #3b82f6; } .pin-color-1.pin-point { border-top-color: #3b82f6; }
.pin-color-2 { border-color: #22c55e; } .pin-color-2.pin-point { border-top-color: #22c55e; }
.pin-color-3 { border-color: #f59e0b; } .pin-color-3.pin-point { border-top-color: #f59e0b; }
.pin-color-4 { border-color: #a855f7; } .pin-color-4.pin-point { border-top-color: #a855f7; }
.pin-color-5 { border-color: #ec4899; } .pin-color-5.pin-point { border-top-color: #ec4899; }

/* --- TOOLTIPS --- */
.map-rich-tooltip {
    position: absolute;
    width: 200px;
    z-index: 100;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(8px);
    border: 2px solid #e2e8f0;
    border-radius: 1rem;
    padding: 0.75rem;
    pointer-events: none;
    transition: all 0.2s ease-out;
    opacity: 0;
    bottom: 130%; 
    left: 50%;
    transform: translateX(-50%) scale(0.9);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
    text-align: center;
}

.league-map-avatar:hover .map-rich-tooltip {
    opacity: 1;
    transform: translateX(-50%) scale(1);
    pointer-events: auto;
}

.tooltip-pos-bottom .map-rich-tooltip { bottom: auto; top: 130%; }
.tooltip-pos-left .map-rich-tooltip { left: auto; right: -20px; transform: translateX(0) scale(0.9); }
.league-map-avatar:hover .tooltip-pos-left .map-rich-tooltip { transform: translateX(0) scale(1); }
.tooltip-pos-right .map-rich-tooltip { left: -20px; right: auto; transform: translateX(0) scale(0.9); }
.league-map-avatar:hover .tooltip-pos-right .map-rich-tooltip { transform: translateX(0) scale(1); }

/* Toggle List Button */
.map-toggle-roster-btn {
    position: absolute; bottom: 1rem; right: 1rem;
    background: white; color: #4F46E5; font-family: 'Fredoka One', cursive;
    padding: 0.5rem 1rem; border-radius: 99px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    z-index: 50; cursor: pointer; transition: transform 0.2s;
}
.map-toggle-roster-btn:hover { transform: scale(1.05); }

/* --- PRODIGY MODAL SPECIFIC STYLES --- */

/* Dark Theme Scrollbar for the Prodigy Modal */
#prodigy-content::-webkit-scrollbar {
    width: 8px;
}
#prodigy-content::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2); 
    border-radius: 4px;
}
#prodigy-content::-webkit-scrollbar-thumb {
    background: linear-gradient(to bottom, #fbbf24, #d97706); /* Gold Gradient */
    border-radius: 4px;
    border: 2px solid rgba(30, 27, 75, 1); /* Matches Indigo-950 bg */
}
#prodigy-content::-webkit-scrollbar-thumb:hover {
    background: #f59e0b; /* Amber-500 */
}
